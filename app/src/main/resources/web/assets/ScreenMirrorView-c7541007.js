import{o as s,c as a,a as e,d as O,u as P,r as h,g as j,x as A,bu as re,i as D,bv as ue,ao as U,t as l,F as B,J as G,m,v as N,j as r,_ as W,O as ce,P as z,Q as de,R as _e,p as k,h as L,k as V,aW as ve,bw as pe,a2 as me,bx as he,by as fe,bz as ge,bA as be,bB as ye,A as $e,B as qe}from"./index-9c78c93b.js";import{_ as Te}from"./refresh-rounded-ca640d8a.js";import{_ as Me}from"./Breadcrumb-56c0fca0.js";const Se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ke=e("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1),we=[ke];function Ce(b,f){return s(),a("svg",Se,we)}const Ie={name:"material-symbols-fullscreen-exit-rounded",render:Ce},Qe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ze=e("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1),Le=[ze];function Ve(b,f){return s(),a("svg",Qe,Le)}const Ae={name:"material-symbols-fullscreen-rounded",render:Ve},De={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"},Be=e("path",{d:"M470.49 0H229.51a41.901 41.901 0 0 0-29.547 12.277 41.898 41.898 0 0 0-12.277 29.547v476.35a41.901 41.901 0 0 0 12.277 29.547 41.898 41.898 0 0 0 29.547 12.277h240.98a41.901 41.901 0 0 0 29.547-12.277 41.898 41.898 0 0 0 12.277-29.547V41.824a41.901 41.901 0 0 0-12.277-29.547A41.898 41.898 0 0 0 470.49 0zm33.25 518.18a33.334 33.334 0 0 1-9.766 23.484 33.335 33.335 0 0 1-23.484 9.766H229.51a33.334 33.334 0 0 1-23.484-9.766 33.335 33.335 0 0 1-9.765-23.484V41.83a33.333 33.333 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.334 33.334 0 0 1 23.484 9.765 33.335 33.335 0 0 1 9.765 23.484z"},null,-1),He=e("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375zM364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.453 16.453 0 0 0 0 16.977 16.584 16.584 0 0 0 6.101 6.386 16.653 16.653 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.803 16.803 0 0 0 0-16.977zm83.562 170.36a8.224 8.224 0 0 1-7.262 4.2H258.91a8.229 8.229 0 0 1-7.176-4.2 8.753 8.753 0 0 1 0-8.75l91-157.5a8.748 8.748 0 0 1 7.262-4.113 8.757 8.757 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),Re=e("path",{d:"M350 221.55a4.288 4.288 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285zm0 91.26a4.289 4.289 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29z"},null,-1),Fe=[Be,He,Re];function Ue(b,f){return s(),a("svg",De,Fe)}const Ge={render:Ue},xe={slot:"headline"},Ee={slot:"content"},Ne={class:"form-row"},Oe=["data-value","label","selected"],Pe={class:"form-row"},je={class:"form-label"},We=["disabled"],Je=["value"],Ye={slot:"headline"},Ke={class:"form-label"},Xe=["disabled"],Ze=["value"],et={slot:"headline"},tt={class:"form-row"},nt={slot:"actions"},ot=["disabled"],st=O({__name:"ChangeScreenMirrorQualityModal",setup(b){const{t:f}=P(),_=h(720),u=h(60),d=h("quality_sd"),v=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],y=[10,20,30,40,50,60,70,80,90,100],T=[480,720,1080];j({handle:(i,c)=>{var n;c?A(f(c),"error"):i&&(_.value=i.screenMirrorQuality.resolution,u.value=i.screenMirrorQuality.quality,d.value=((n=v.find(p=>{var M,Q;return((M=p.data)==null?void 0:M.resolution)===_.value&&((Q=p.data)==null?void 0:Q.quality)===u.value}))==null?void 0:n.id)||"custom")},document:re,appApi:!0});function C(i){const{button:c}=i.detail,n=c.dataset.value;d.value=n;const p=v.find(M=>M.id===n);p&&p.data&&(_.value=p.data.resolution,u.value=p.data.quality)}const{mutate:w,loading:I,onDone:g}=D({document:ue,appApi:!0});g(()=>{U()});const R=()=>{w({resolution:_.value,quality:u.value})};return(i,c)=>(s(),a("md-dialog",null,[e("div",xe,l(i.$t("change_quality")),1),e("div",Ee,[e("div",Ne,[e("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:C},[(s(),a(B,null,G(v,n=>e("md-outlined-segmented-button",{key:n.id,"data-value":n.id,label:i.$t(n.id),selected:d.value===n.id},null,8,Oe)),64))],32)]),e("div",Pe,[e("label",je,l(i.$t("compress_quality")),1),m(e("md-outlined-select",{"menu-positioning":"fixed","onUpdate:modelValue":c[0]||(c[0]=n=>u.value=n),disabled:d.value!=="custom"},[(s(),a(B,null,G(y,n=>e("md-select-option",{key:n,value:n},[e("div",Ye,l(n),1)],8,Je)),64))],8,We),[[N,u.value,void 0,{number:!0}]]),e("label",Ke,l(i.$t("resolution")),1),m(e("md-outlined-select",{"menu-positioning":"fixed","onUpdate:modelValue":c[1]||(c[1]=n=>_.value=n),disabled:d.value!=="custom"},[(s(),a(B,null,G(T,n=>e("md-select-option",{key:n,value:n},[e("div",et,l(n)+"p",1)],8,Ze)),64))],8,Xe),[[N,_.value,void 0,{number:!0}]])]),e("div",tt,l(i.$t("screen_mirror_quality_tips")),1)]),e("div",nt,[e("md-outlined-button",{value:"cancel",onClick:c[2]||(c[2]=(...n)=>r(U)&&r(U)(...n))},l(i.$t("cancel")),1),e("md-filled-button",{value:"save",disabled:r(I),onClick:R,autofocus:""},l(i.$t("save")),9,ot)])]))}});const at=W(st,[["__scopeId","data-v-009cf53c"]]),H=b=>($e("data-v-a796420e"),b=b(),qe(),b),lt={class:"main"},it={class:"v-toolbar"},rt=H(()=>e("md-ripple",null,null,-1)),ut=["disabled"],ct=H(()=>e("md-ripple",null,null,-1)),dt=H(()=>e("md-ripple",null,null,-1)),_t={class:"panel-container"},vt={key:0,class:"loading"},pt=H(()=>e("md-circular-progress",{indeterminate:""},null,-1)),mt=[pt],ht={key:1,class:"request-permission"},ft={class:"tap-phone"},gt={class:"text"},bt={key:2,class:"request-permission-failed"},yt=O({__name:"ScreenMirrorView",setup(b){let f;const{t:_}=P(),u=h(!1),d=h(0),v=h(!1),y=h(!1),T=h(!1),C=h(),w=h(),I=async t=>{u.value=!0,Q(t),v.value=!1,d.value=0,clearInterval(f)};let g=!1;const{mutate:R}=D({document:pe,appApi:!0}),i=()=>{y.value=!y.value,y.value||x()},c=()=>{me(at)},n=()=>{R(),g=!0},p=t=>{t&&g&&(g=!1,clearInterval(f),F())},M=()=>{const t=w.value;if(!t)return;const o=new Date,S="screenshot-"+[o.getFullYear(),o.getMonth()+1,o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds()].join("")+".png";he(t.toDataURL(),S)};function Q(t){const o=w.value;if(!o||y.value&&!T.value)return;T.value=!1;const S=o.getContext("2d"),$=new Image;$.src=URL.createObjectURL(t),$.onload=function(){S&&(o.width=$.width,o.height=$.height,S.drawImage($,0,0))}}ce(()=>{z.on("screen_mirroring",I),z.on("app_socket_connection_changed",p)}),de(()=>{z.off("screen_mirroring",I),z.off("app_socket_connection_changed",p)});const{mutate:J,loading:Y,onDone:K,onError:X}=D({document:fe,appApi:!0}),{loading:Z,refetch:x}=j({handle:(t,o)=>{o?A(_(o),"error"):t.screenMirrorState?(u.value=!0,T.value=!0):(u.value=!1,T.value=!1,F())},options:{fetchPolicy:"no-cache"},document:ge,appApi:!0}),ee=()=>{var t;(t=C.value)==null||t.requestFullscreen({navigationUI:"show"})},F=()=>{v.value=!1,J()},te=()=>{document.exitFullscreen()};X(t=>{A(_(t.message)),v.value=!0}),K(()=>{d.value=30,f=setInterval(()=>{d.value--,d.value<=0&&(v.value=!0,clearInterval(f))},1e3)});const{mutate:E,loading:ne,onDone:oe,onError:se}=D({document:be,appApi:!0});return se(t=>{A(_(t.message))}),oe(()=>{v.value=!0,u.value=!1}),(t,o)=>{const S=Me,$=Te,ae=Ae,le=Ie,q=_e("tooltip");return s(),a("div",{ref_key:"containerRef",ref:C,class:"page-container"},[e("div",lt,[e("div",it,[k(S,{current:()=>t.$t("screen_mirror")},null,8,["current"]),u.value?(s(),a(B,{key:0},[m((s(),a("button",{class:"icon-button",onClick:o[0]||(o[0]=()=>r(x)())},[rt,k($)])),[[q,t.$t("refresh")]]),m((s(),a("md-outlined-button",{onClick:c,class:"btn-sm"},[L(l(t.$t("mirror_quality")),1)])),[[q,t.$t("change_quality")]]),m((s(),a("md-outlined-button",{onClick:M,class:"btn-sm"},[L(l(t.$t("screenshot")),1)])),[[q,t.$t("screenshot")]]),m((s(),a("md-outlined-button",{onClick:i,class:"btn-sm"},[L(l(t.$t(y.value?"resume":"pause")),1)])),[[q,t.$t(y.value?"resume":"pause")]]),m((s(),a("md-outlined-button",{disabled:r(ne),onClick:o[1]||(o[1]=(...ie)=>r(E)&&r(E)(...ie)),class:"btn-sm btn-stop"},[L(l(t.$t("stop_mirror")),1)],8,ut)),[[q,t.$t("stop_mirror")]]),m((s(),a("button",{class:"icon-button btn-enter-fullscreen",onClick:ee},[ct,k(ae)])),[[q,t.$t("fullscreen")]]),m((s(),a("button",{class:"icon-button btn-exit-fullscreen",onClick:te},[dt,k(le)])),[[q,t.$t("exit_fullscreen")]])],64)):r(g)?V("",!0):(s(),a("md-outlined-button",{key:1,class:"btn-sm",onClick:n},l(t.$t("relaunch_app")),1))]),e("div",_t,[r(Z)||r(Y)||r(g)?(s(),a("div",vt,mt)):V("",!0),d.value>0&&!r(g)?(s(),a("div",ht,[e("div",ft,[k(r(ye))]),e("pre",gt,l(t.$t("screen_mirror_request_permission",{seconds:d.value})),1)])):V("",!0),v.value&&!u.value&&!r(g)?(s(),a("div",bt,[k(r(Ge)),e("p",null,l(t.$t("screen_mirror_request_permission_failed")),1),e("md-filled-button",{onClick:F},l(t.$t("try_again")),1)])):V("",!0),m(e("canvas",{ref_key:"canvasRef",ref:w,class:"canvas"},null,512),[[ve,u.value]])])])],512)}}});const Mt=W(yt,[["__scopeId","data-v-a796420e"]]);export{Mt as default};
