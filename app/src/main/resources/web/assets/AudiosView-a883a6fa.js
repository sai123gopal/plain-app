import{u as kt,_ as $t,a as Ct}from"./list-d04dc80e.js";import{o as u,c as p,e as t,Z as Y,ay as Tt,u as tt,M as g,t as D,r as f,az as wt,d as qt,q as Vt,s as At,a as It,C as St,H as I,p as Mt,D as Dt,E as Bt,G as Lt,a4 as Qt,aq as Pt,I as Rt,aA as Ut,K as Zt,L as zt,f as i,j as n,F as w,w as d,l as S,g as a,y as Ft,N as M,O as Nt,P as Et,Q as x,R as Gt,A as W,z as Kt,aB as Ht,U as j,a0 as Ot,m as xt,a9 as Wt,B as X,V as J,ai as jt,W as Xt,a1 as Jt,aC as Yt,aa as to,ab as oo,_ as eo}from"./index-cf22a9d8.js";import{_ as so}from"./FieldId-4280c3b8.js";import{_ as no}from"./Multiselect-94708f99.js";import{_ as ao,a as lo}from"./label-outline-rounded-bf459c02.js";import{_ as io}from"./download-rounded-1a2e3353.js";import{_ as uo}from"./delete-outline-rounded-11fb4e46.js";import{_ as co}from"./Breadcrumb-99ff7c19.js";import{n as ro}from"./list-6498ebd9.js";import{u as _o,a as po,b as mo}from"./tags-8dfd5c3d.js";import{u as ho,_ as bo}from"./ConfirmModal.vuevuetypescriptsetuptruelang-3c36884b.js";import{_ as yo}from"./DeleteConfirm.vuevuetypescriptsetuptruelang-1943d7a1.js";import"./VModal.vuevuetypescriptsetuptruelang-83ac7574.js";import"./vee-validate.esm-dd3b5249.js";const vo={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},fo=t("path",{fill:"currentColor",d:"M9.5 9.325v5.35q0 .6.525.875t1.025-.05l4.15-2.65q.475-.275.475-.85t-.475-.85L11.05 8.5q-.5-.325-1.025-.05t-.525.875ZM12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-10Zm0 8q3.325 0 5.663-2.337T20 12q0-3.325-2.337-5.663T12 4Q8.675 4 6.337 6.337T4 12q0 3.325 2.337 5.663T12 20Z"},null,-1),go=[fo];function ko(c,m){return u(),p("svg",vo,go)}const $o={name:"material-symbols-play-circle-outline-rounded",render:ko},Co={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},To=t("path",{fill:"currentColor",d:"M3 16v-2h7v2H3Zm0-4v-2h11v2H3Zm0-4V6h11v2H3Zm13 12v-4h-4v-2h4v-4h2v4h4v2h-4v4h-2Z"},null,-1),wo=[To];function qo(c,m){return u(),p("svg",Co,wo)}const Vo={name:"material-symbols-playlist-add",render:qo},Ao=c=>{const{mutate:m,loading:l,onDone:y}=Y({document:Tt,appApi:!0}),{t:_}=tt();return y(()=>{g.emit("refetch_app"),D(_("added_to_playlist"))}),{loading:l,addItemsToPlaylist:()=>{const r=c.value.filter(k=>k.checked);if(r.length===0){D(_("select_first"),"error");return}m({paths:r.map(k=>k.path)})},addToPlaylist:r=>{m({paths:[r.path]})}}},Io=()=>{const c=f(""),{mutate:m,loading:l,onDone:y}=Y({document:wt,appApi:!0});return y(()=>{g.emit("refetch_app"),g.emit("play_audio")}),{loading:l,playing:c,play:_=>{c.value=_.path,m({path:_.path})}}},ot=c=>(to("data-v-9b7d5697"),c=c(),oo(),c),So={class:"v-toolbar"},Mo={class:"right-actions"},Do=["title"],Bo=["title"],Lo=["title"],Qo=["title"],Po=["title"],Ro=["onClick"],Uo={class:"row mb-3"},Zo={class:"col-md-3 col-form-label"},zo={class:"col-md-9"},Fo=["onKeyup"],No={class:"row mb-3"},Eo={class:"col-md-3 col-form-label"},Go={class:"col-md-9"},Ko={class:"actions"},Ho=["onClick"],Oo={class:"table"},xo=ot(()=>t("th",null,"ID",-1)),Wo=ot(()=>t("th",null,null,-1)),jo=["onClick"],Xo=["onUpdate:modelValue"],Jo={class:"nowrap"},Yo={class:"audio-btns"},te={key:0,class:"spinner spinner-sm"},oe={class:"badge"},ee={key:0},se={colspan:"8"},ne={class:"no-data-placeholder"},ae=qt({__name:"AudiosView",setup(c){var E,G;const m=Vt(),l=f([]),{t:y}=tt(),{app:_}=At(It()),r=St({text:"",tags:[]}),k=I(()=>_.value.audios??[]);I(()=>{const e=_.value.audioCurrent;return k.value.find(s=>s.path==e)});const et=I(()=>l.value.some(e=>e.checked)),b="AUDIO",B=Mt().query,$=f(parseInt(((E=B.page)==null?void 0:E.toString())??"1")),C=50,T=f(0),v=f(Dt(((G=B.q)==null?void 0:G.toString())??"")),L=f(""),{tags:q}=_o(b,v,r,async e=>{L.value=Bt(e),await Lt(),ct()}),{addItemsToPlaylist:Q,addToPlaylist:st}=Ao(l),{addToTags:P}=po(b,l,q),{removeFromTags:R}=mo(b,l,q),{deleteItems:U}=ho(b,l),{downloadItems:Z}=Qt(l,"audios.zip"),{downloadFile:nt}=Wt(_),at=Pt(),{play:lt,playing:it,loading:dt}=Io(),{selectAll:V,toggleSelect:z}=kt(l),{loading:ut,load:ct,refetch:rt}=Rt({handle:(e,s)=>{s?D(y(s),"error"):e&&(l.value=e.audios.map(A=>({...A,checked:!1})),T.value=e.audioCount)},document:Ut,variables:()=>({offset:($.value-1)*C,limit:C,query:L.value}),appApi:!0});Zt($,e=>{X(m,`/audios?page=${e}&q=${J(v.value)}`)});function _t(){at.push("/files"),jt(bo,{message:y("upload_audios")})}function F(){v.value=Xt(r),N()}function N(){X(m,`/audios?q=${J(v.value)}`)}zt(()=>{g.on("refetch_by_tag_type",e=>{e===b&&rt()})});function pt(e){Jt(yo,{id:e.id,name:e.title,gql:Yt,variables:()=>({tagType:b,id:e.id}),appApi:!0,typeName:"Audio",done:()=>{g.emit("refetch_app"),g.emit("refetch_by_tag_type",b)}})}return(e,s)=>{const A=co,K=uo,H=io,O=Vo,mt=ao,ht=lo,bt=no,yt=$t,vt=so,ft=$o,gt=Ct;return u(),p(w,null,[t("div",So,[i(A,{current:()=>`${e.$t("page_title.audios")} (${T.value})`},null,8,["current"]),t("div",Mo,[n(et)?(u(),p(w,{key:0},[t("button",{type:"button",class:"btn btn-action",onClick:s[0]||(s[0]=d((...o)=>n(U)&&n(U)(...o),["stop"])),title:e.$t("delete")},[i(K,{class:"bi"})],8,Do),t("button",{type:"button",class:"btn btn-action",onClick:s[1]||(s[1]=d((...o)=>n(Z)&&n(Z)(...o),["stop"])),title:e.$t("download")},[i(H,{class:"bi"})],8,Bo),t("button",{type:"button",class:"btn btn-action",onClick:s[2]||(s[2]=d((...o)=>n(Q)&&n(Q)(...o),["stop"])),title:e.$t("add_to_playlist")},[i(O,{class:"bi"})],8,Lo),t("button",{type:"button",class:"btn btn-action",onClick:s[3]||(s[3]=d((...o)=>n(P)&&n(P)(...o),["stop"])),title:e.$t("add_to_tags")},[i(mt,{class:"bi"})],8,Qo),t("button",{type:"button",class:"btn btn-action",onClick:s[4]||(s[4]=d((...o)=>n(R)&&n(R)(...o),["stop"])),title:e.$t("remove_from_tags")},[i(ht,{class:"bi"})],8,Po)],64)):S("",!0),t("button",{type:"button",class:"btn btn-action",onClick:d(_t,["stop"])},a(e.$t("upload")),9,Ro),i(yt,{modelValue:v.value,"onUpdate:modelValue":s[7]||(s[7]=o=>v.value=o),search:N},{filters:Ft(()=>[t("div",Uo,[t("label",Zo,a(e.$t("keywords")),1),t("div",zo,[M(t("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>r.text=o),class:"form-control",onKeyup:Et(F,["enter"])},null,40,Fo),[[Nt,r.text]])])]),t("div",No,[t("label",Eo,a(e.$t("tags")),1),t("div",Go,[i(bt,{modelValue:r.tags,"onUpdate:modelValue":s[6]||(s[6]=o=>r.tags=o),label:"name","track-by":"id",options:n(q)},null,8,["modelValue","options"])])]),t("div",Ko,[t("button",{type:"button",class:"btn",onClick:d(F,["stop"])},a(e.$t("search")),9,Ho)])]),_:1},8,["modelValue"])])]),t("table",Oo,[t("thead",null,[t("tr",null,[t("th",null,[M(t("input",{class:"form-check-input",type:"checkbox",onChange:s[8]||(s[8]=(...o)=>n(z)&&n(z)(...o)),"onUpdate:modelValue":s[9]||(s[9]=o=>Gt(V)?V.value=o:null)},null,544),[[x,n(V)]])]),xo,t("th",null,a(e.$t("name")),1),Wo,t("th",null,a(e.$t("artist")),1),t("th",null,a(e.$t("tags")),1),t("th",null,a(e.$t("duration")),1),t("th",null,a(e.$t("file_size")),1)])]),t("tbody",null,[(u(!0),p(w,null,W(l.value,o=>(u(),p("tr",{key:o.id,class:Kt({checked:o.checked}),onClick:d(h=>o.checked=!o.checked,["stop"])},[t("td",null,[M(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":h=>o.checked=h},null,8,Xo),[[x,o.checked]])]),t("td",null,[i(vt,{id:o.id,raw:o},null,8,["id","raw"])]),t("td",null,a(o.title),1),t("td",Jo,[t("span",Yo,[i(K,{class:"bi bi-btn",onClick:d(h=>pt(o),["stop"])},null,8,["onClick"]),i(H,{class:"bi bi-btn",onClick:d(h=>n(nt)(o.path,n(Ht)(o.path).replace(" ","-")),["stop"])},null,8,["onClick"]),i(O,{class:"bi bi-btn",onClick:d(h=>n(st)(o),["stop"])},null,8,["onClick"]),n(dt)&&o.path===n(it)?(u(),p("i",te)):(u(),j(ft,{key:1,class:"bi bi-btn",onClick:d(h=>n(lt)(o),["stop"])},null,8,["onClick"]))])]),t("td",null,a(o.artist),1),t("td",null,[(u(!0),p(w,null,W(o.tags,h=>(u(),p("span",oe,a(h.name),1))),256))]),t("td",null,a(n(Ot)(o.duration)),1),t("td",null,a(n(xt)(o.size)),1)],10,jo))),128))]),l.value.length?S("",!0):(u(),p("tfoot",ee,[t("tr",null,[t("td",se,[t("div",ne,a(e.$t(n(ro)(n(ut),n(_).permissions,"WRITE_EXTERNAL_STORAGE"))),1)])])]))]),T.value>C?(u(),j(gt,{key:0,modelValue:$.value,"onUpdate:modelValue":s[10]||(s[10]=o=>$.value=o),total:T.value,limit:C},null,8,["modelValue","total"])):S("",!0)],64)}}});const ke=eo(ae,[["__scopeId","data-v-9b7d5697"]]);export{ke as default};
