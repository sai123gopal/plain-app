var P=Object.defineProperty;var Q=(i,s,t)=>s in i?P(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t;var w=(i,s,t)=>(Q(i,typeof s!="symbol"?s+"":s,t),t);import{_ as W}from"./MonacoEditor.vuevuetypescriptsetuptruelang-BNZRjtJE.js";import{o as M,c as E,a as e,d as A,g as G,h as v,au as S,l as J,C as K,ac as B,c0 as D,j as X,p as g,m as l,x as r,aL as _,t as p,z as H,y as Y,c1 as Z,w as ee,O as te}from"./index-R8dLcqG_.js";import{_ as se}from"./EditToolbar.vuevuetypescriptsetuptruelang-CKd0R4yf.js";import{_ as oe}from"./Breadcrumb-CXy0PDtB.js";import{u as ne,a as U}from"./vee-validate.esm-vpr6zxQb.js";const ae={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},le=e("path",{fill:"currentColor",d:"M12 16q1.875 0 3.188-1.312T16.5 11.5t-1.312-3.187T12 7T8.813 8.313T7.5 11.5t1.313 3.188T12 16m0-1.8q-1.125 0-1.912-.788T9.3 11.5t.788-1.912T12 8.8t1.913.788t.787 1.912t-.787 1.913T12 14.2m0 4.8q-3.35 0-6.113-1.8t-4.362-4.75q-.125-.225-.187-.462t-.063-.488t.063-.488t.187-.462q1.6-2.95 4.363-4.75T12 4t6.113 1.8t4.362 4.75q.125.225.188.463t.062.487t-.062.488t-.188.462q-1.6 2.95-4.362 4.75T12 19m0-2q2.825 0 5.188-1.487T20.8 11.5q-1.25-2.525-3.613-4.012T12 6T6.813 7.488T3.2 11.5q1.25 2.525 3.613 4.013T12 17"},null,-1),ie=[le];function ce(i,s){return M(),E("svg",ae,[...ie])}const de={name:"material-symbols-visibility-outline-rounded",render:ce},re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ue=e("path",{fill:"currentColor",d:"M15.175 8.325q.725.725 1.063 1.65t.237 1.9q0 .375-.275.638t-.65.262t-.638-.262t-.262-.638q.125-.65-.075-1.25T13.95 9.6t-1.025-.65t-1.275-.1q-.375 0-.638-.275t-.262-.65t.263-.637t.637-.263q.95-.1 1.875.238t1.65 1.062M12 6q-.475 0-.925.037t-.9.138q-.425.075-.763-.125t-.462-.6t.088-.775t.612-.45q.575-.125 1.163-.175T12 4q3.425 0 6.263 1.8t4.337 4.85q.1.2.15.413t.05.437t-.038.438t-.137.412q-.45 1-1.112 1.875t-1.463 1.6q-.3.275-.7.225t-.65-.4t-.212-.763t.337-.687q.6-.575 1.1-1.25t.875-1.45q-1.25-2.525-3.613-4.012T12 6m0 13q-3.35 0-6.125-1.812T1.5 12.425q-.125-.2-.187-.437T1.25 11.5t.05-.475t.175-.45q.5-1 1.163-1.912T4.15 7L2.075 4.9q-.275-.3-.262-.712T2.1 3.5t.7-.275t.7.275l17 17q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275l-3.5-3.45q-.875.275-1.775.413T12 19M5.55 8.4q-.725.65-1.325 1.425T3.2 11.5q1.25 2.525 3.613 4.013T12 17q.5 0 .975-.062t.975-.138l-.9-.95q-.275.075-.525.113T12 16q-1.875 0-3.188-1.312T7.5 11.5q0-.275.038-.525t.112-.525zm4.2 4.2"},null,-1),me=[ue];function _e(i,s){return M(),E("svg",re,[...me])}const pe={name:"material-symbols-visibility-off-outline-rounded",render:_e};class T{constructor(){w(this,"line","");w(this,"key","");w(this,"value","")}update(s,t){this.line=this.line.replace(new RegExp(`^(${s}s*=s*).+$`),(o,n)=>n+t),this.value=t}static create(s,t){const o=new T;return o.key=s,o.value=t,o.line=`${s} = ${t}`,o}}function I(i){const s=[],t=i.split(`
`);for(const o of t){const n=o.split("="),d=new T;d.line=o,n.length>1&&(d.key=n[0].trimEnd(),d.value=n[1].trimStart()),s.push(d)}return s}function V(i,s,t){let o=i.find(n=>n.key==s);o?o.update(s,t):(o=T.create(s,t),i.push(o))}const he={class:"row mb-3"},fe={for:"is-enabled",class:"col-sm-3 col-md-2 col-form-label"},ve={class:"col-sm-4"},ge={class:"form-check"},be=["checked"],qe={class:"row mb-3"},we={for:"ssid",class:"col-sm-3 col-md-2 col-form-label"},Te={class:"col-sm-4"},ye={class:"row mb-3"},$e={for:"password",class:"col-sm-3 col-md-2 col-form-label"},ke={class:"col-sm-4"},xe={class:"input-group"},Ce=["type"],Ve={class:"inner"},Me={class:"row mb-3"},Ee={for:"hide-ssid",class:"col-sm-3 col-md-2 col-form-label"},Fe={class:"col-sm-4"},Se={class:"form-check"},Be=["checked"],ze=A({__name:"WiFiView",setup(i){const{handleSubmit:s}=ne(),{t}=G(),o=v(0),n=v(""),{value:d,errorMessage:y}=U("password",S().required().min(8)),{value:h,errorMessage:$}=U("ssid",S().required()),f=v(!1),k=v(!1),x=v(!1);function L(){f.value=!f.value}J({handle:(c,a)=>{a?K(t(a),"error"):(n.value=c.hostapd.config,k.value=c.hostapd.isEnabled,F())},document:B`
    query {
      hostapd {
        ...HostapdFragment
      }
    }
    ${D}
  `});const{mutate:j,loading:z}=X({document:B`
    mutation applyHostapd($config: String!, $enable: Boolean!) {
      applyHostapd(config: $config, enable: $enable) {
        ...HostapdFragment
      }
    }
    ${D}
  `}),N=s(async()=>{n.value&&j({config:n.value,enable:k.value})});function C(){const c=I(n.value);V(c,"ssid",h.value??""),V(c,"wpa_passphrase",d.value??""),V(c,"ignore_broadcast_ssid",x.value?"1":"0"),n.value=c.map(a=>a.line).join(`
`)}function F(){var a,b,q;const c=I(n.value);h.value=((a=c.find(u=>u.key=="ssid"))==null?void 0:a.value)??"",d.value=((b=c.find(u=>u.key=="wpa_passphrase"))==null?void 0:b.value)??"",x.value=((q=c.find(u=>u.key=="ignore_broadcast_ssid"))==null?void 0:q.value)==="1"}return(c,a)=>{const b=oe,q=se,u=pe,R=de,O=W;return M(),E(te,null,[g(b,{current:()=>c.$t("page_title.wifi")},null,8,["current"]),g(q,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=m=>o.value=m),save:l(N),loading:l(z),tabs:["t:basic","/etc/hostapd/hostapd.conf"]},null,8,["modelValue","save","loading"]),r(e("form",null,[e("div",he,[e("label",fe,p(l(t)("enable")),1),e("div",ve,[e("div",ge,[e("md-checkbox",{"touch-target":"wrapper",checked:k.value,id:"is-enabled"},null,8,be)])])]),e("div",qe,[e("label",we,p(l(t)("wifi.ssid")),1),e("div",Te,[r(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=m=>H(h)?h.value=m:null),class:"form-control",id:"ssid",onChange:C},null,544),[[Y,l(h)]]),r(e("div",{class:"invalid-feedback"},p(l($)?l(t)(l($)):""),513),[[_,l($)]])])]),e("div",ye,[e("label",$e,p(l(t)("password")),1),e("div",ke,[e("div",xe,[r(e("input",{class:"form-control","onUpdate:modelValue":a[2]||(a[2]=m=>H(d)?d.value=m:null),id:"password",onChange:C,type:f.value?"text":"password"},null,40,Ce),[[Z,l(d)]]),e("a",{href:"#",onClick:ee(L,["prevent"]),class:"input-group-text"},[e("span",Ve,[r(g(u,null,null,512),[[_,f.value]]),r(g(R,null,null,512),[[_,!f.value]])])])]),r(e("div",{class:"invalid-feedback"},p(l(y)?l(t)(l(y),{min:8}):""),513),[[_,l(y)]])])]),e("div",Me,[e("label",Ee,p(l(t)("wifi.hide_ssid")),1),e("div",Fe,[e("div",Se,[e("md-checkbox",{"touch-target":"wrapper",checked:x.value,onChange:C,id:"hide-ssid"},null,40,Be)])])])],512),[[_,o.value===0]]),r(g(O,{language:"ini",onChange:F,height:"700",modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=m=>n.value=m)},null,8,["modelValue"]),[[_,o.value===1]])],64)}}});export{ze as default};
