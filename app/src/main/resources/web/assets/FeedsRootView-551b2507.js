import{a as ae,_ as le}from"./TagFilter.vuevuetypescriptsetuptruelang-96447d4e.js";import{d as N,r as y,i as D,c9 as ie,g as P,V as U,ao as V,o as g,c as C,a as t,t as i,n as R,v as j,k as e,p as H,ap as J,j as I,_ as de,ca as ce,u as re,e as ue,E as pe,G as _e,cb as fe,h as me,cc as ve,y as G,H as he,S as be,q as w,I as L,cd as $e,ce as ke,cf as ge,F as S,K as T,m as B,J as K,bJ as z,a3 as q,U as Ce,D as E,X as ye,aH as Fe,cg as xe,ad as we}from"./index-2583f876.js";import{g as O,M as Me}from"./splitpanes.es-96eec7b1.js";import{u as X,a as Y}from"./vee-validate.esm-b0601c3b.js";import"./EditValueModal-13c70216.js";const Ae={slot:"headline"},Ve={slot:"content"},De={class:"form-row"},Le=["label","error","error-text"],qe={class:"form-row"},Ee={class:"form-check-label"},Ne=["checked"],Re={slot:"actions"},Ie=["disabled"],Qe=N({__name:"AddFeedModal",props:{done:{type:Function}},setup(M){const d=M,{handleSubmit:b}=X(),f=y(),c=y(!1);function $(o){c.value=o.target.checked}const{mutate:m,loading:F,onDone:k}=D({document:ie,appApi:!0}),{value:l,resetField:v,errorMessage:r}=Y("inputValue",P().required());v();function x(){V()}(async()=>{var o;await U(),(o=f.value)==null||o.focus()})();const p=b(()=>{m({url:l.value??"",fetchContent:c.value})});return k(()=>{var o;(o=d.done)==null||o.call(this),V()}),(o,n)=>(g(),C("md-dialog",null,[t("div",Ae,i(o.$t("add_subscription")),1),t("div",Ve,[t("div",De,[R(t("md-outlined-text-field",{ref_key:"inputRef",ref:f,label:o.$t("rss_url"),"onUpdate:modelValue":n[0]||(n[0]=u=>H(l)?l.value=u:null),onKeyup:n[1]||(n[1]=J((...u)=>e(p)&&e(p)(...u),["enter"])),error:e(r),"error-text":e(r)?o.$t(e(r)):""},null,40,Le),[[j,e(l)]])]),t("div",qe,[t("label",Ee,[t("md-checkbox",{"touch-target":"wrapper",onChange:$,checked:c.value},null,40,Ne),I(" "+i(o.$t("fetch_content_automatically")),1)])])]),t("div",Re,[t("md-outlined-button",{value:"cancel",onClick:x},i(o.$t("cancel")),1),t("md-filled-button",{value:"save",disabled:e(F),onClick:n[2]||(n[2]=(...u)=>e(p)&&e(p)(...u)),autofocus:""},i(o.$t("save")),9,Ie)])]))}});const Ge=de(Qe,[["__scopeId","data-v-cd35ee4b"]]),Se={slot:"headline"},Te={slot:"content"},Be={class:"form-label"},Ke={class:"form-row"},ze=["label","error","error-text"],Oe={class:"form-row"},Pe={class:"form-check-label"},Ue=["checked"],je={slot:"actions"},He=["disabled"],Je=N({__name:"FeedModal",props:{data:{type:Object}},setup(M){var x,p;const d=M,{handleSubmit:b}=X(),f=y(),c=y(!1);function $(o){c.value=o.target.checked}const{mutate:m,loading:F,onDone:k}=D({document:ce,appApi:!0}),{value:l,errorMessage:v}=Y("inputValue",P().required());l.value=((x=d.data)==null?void 0:x.name)??"",c.value=((p=d.data)==null?void 0:p.fetchContent)??!1,(async()=>{var o;await U(),(o=f.value)==null||o.focus()})();const r=b(()=>{var o;m({id:(o=d.data)==null?void 0:o.id,name:l.value,fetchContent:c.value})});return k(()=>{V()}),(o,n)=>{var u;return g(),C("md-dialog",null,[t("div",Se,i(o.$t("update_subscription")),1),t("div",Te,[t("div",Be,i((u=M.data)==null?void 0:u.url),1),t("div",Ke,[R(t("md-outlined-text-field",{ref_key:"inputRef",ref:f,class:"form-control",label:o.$t("name"),error:e(v),"error-text":e(v)?o.$t(e(v)):"","onUpdate:modelValue":n[0]||(n[0]=_=>H(l)?l.value=_:null),onKeyup:n[1]||(n[1]=J((..._)=>e(r)&&e(r)(..._),["enter"]))},null,40,ze),[[j,e(l)]])]),t("div",Oe,[t("label",Pe,[t("md-checkbox",{"touch-target":"wrapper",onChange:$,checked:c.value},null,40,Ue),I(" "+i(o.$t("fetch_content_automatically")),1)])])]),t("div",je,[t("md-outlined-button",{value:"cancel",onClick:n[2]||(n[2]=(..._)=>e(V)&&e(V)(..._))},i(o.$t("cancel")),1),t("md-filled-button",{value:"save",disabled:e(F),onClick:n[3]||(n[3]=(..._)=>e(r)&&e(r)(..._)),autofocus:""},i(o.$t("save")),9,He)])])}}}),Xe={class:"page-container"},Ye={class:"sidebar"},We={class:"nav-title"},Ze={style:{position:"relative"}},et=t("md-ripple",null,null,-1),tt=["open"],ot=["onClick"],nt={slot:"headline"},st={class:"nav"},at=["onClick"],lt=["onClick","onContextmenu"],it={class:"main"},_t=N({__name:"FeedsRootView",setup(M){const{t:d}=re(),b=ue(),f=y([]),c=[{text:"add_subscription",click:x},{text:"import_opml_file",click:_},{text:"export_opml_file",click:W}],$=y(!1),m=pe(),F=_e(m.query),k=fe(m.query),l=y(),{refetch:v}=me({handle:(s,a)=>{a?G(d(a),"error"):s&&(f.value=s.feeds)},document:$e,appApi:!0});function r(s){const a=s.target.files;if(!a)return;const A=new FileReader;A.addEventListener("load",()=>{n({content:A.result})},!1),A.readAsText(a[0])}function x(){q(Ge,{done:()=>{v()}})}const{mutate:p,onDone:o}=D({document:ke,appApi:!0});o(s=>{ve(s.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:n,onDone:u}=D({document:ge,appApi:!0});u(()=>{G(d("imported")),v()});function _(){l.value.value="",l.value.click()}function W(){p()}function Z(s){const a=Ce([{name:"feed",op:"",value:z(s.name)}]);E(b,`/feeds?q=${ye(a)}`)}function ee(s,a){s.preventDefault(),Fe({x:s.x,y:s.y,items:[{label:d("edit"),onClick:()=>{q(Je,{data:a})}},{label:d("delete"),onClick:()=>{q(we,{id:a.id,name:a.name,gql:xe,appApi:!0,typeName:"Feed",done:()=>{E(b,"/feeds")}})}}]})}function te(){E(b,"/feeds")}return(s,a)=>{const A=ae,oe=le,ne=he("router-view"),se=be("tooltip");return g(),C("div",Xe,[w(e(Me),null,{default:L(()=>[w(e(O),{size:"20","min-size":"10"},{default:L(()=>[t("div",Ye,[t("h2",We,[I(i(s.$t("page_title.feeds"))+" ",1),t("div",Ze,[R((g(),C("button",{class:"icon-button",id:"add-feed-ref",onClick:a[0]||(a[0]=()=>$.value=!0)},[et,w(A)])),[[se,e(d)("add_subscription")]]),t("md-menu",{anchor:"add-feed-ref",positioning:"fixed","stay-open-on-focusout":"",quick:"",open:$.value,onClosed:a[1]||(a[1]=()=>$.value=!1)},[(g(),C(S,null,T(c,h=>t("md-menu-item",{onClick:h.click},[t("div",nt,i(s.$t(h.text)),1)],8,ot)),64))],40,tt)])]),t("ul",st,[t("li",{onClick:B(te,["prevent"]),class:K({active:e(m).path==="/feeds"&&!e(F)&&!e(k)})},i(s.$t("all")),11,at),(g(!0),C(S,null,T(f.value,h=>(g(),C("li",{onClick:B(Q=>Z(h),["stop","prevent"]),onContextmenu:Q=>ee(Q,h),class:K({active:e(m).params.feedId===h.id||e(k)&&e(z)(h.name)===e(k)})},i(h.name),43,lt))),256))]),w(oe,{type:"FEED_ENTRY",selected:e(F)},null,8,["selected"])])]),_:1}),w(e(O),null,{default:L(()=>[t("div",it,[w(ne)])]),_:1})]),_:1}),t("input",{ref_key:"fileInput",ref:l,style:{display:"none"},accept:".xml",type:"file",onChange:r},null,544)])}}});export{_t as default};
