import{d as U,bB as Q,r as p,K as H,L,bC as F,x as X,o as C,c as _,N as D,ae as T,e as x,F as Y,A as ee,z as B,g as ne,l as I,bA as E,U as N,j as l,aa as te,ab as oe,_ as se,bk as le,bD as j}from"./index-cf22a9d8.js";const K=t=>(te("data-v-e2959c42"),t=t(),oe(),t),ae=K(()=>x("span",{class:"right-arrow"},null,-1)),ie=[ae],ue=K(()=>x("span",{class:"right-arrow"},null,-1)),ce=[ue],de=["onMouseenter","onFocus","onClick"],re={class:"text"},pe={key:0,class:"right-arrow"},fe=U({__name:"ContextSubMenu",props:{items:{type:Object,default:null},parentItem:{type:Object,default:null},options:{type:Object,default:null},zIndex:{type:Number,default:0},globalData:{type:Object,default:null},position:{type:Object,default:null}},emits:["close","keepOpen","preUpdatePos"],setup(t,{emit:o}){const f=t,{globalData:i,position:u,options:v,parentItem:a}=Q(f),h=p(),b=p(),c=p(!1),w=p(!1);let m=null;const g=p(0),d=p(null),z=p({parentPosition:{x:0,y:0},screenSize:i.value.screenSize}),S=p({x:0,y:0});function W(n,e){if(e.disabled||!e.children||e.children.length==0||d.value===e)return;d.value=e,z.value.parentPosition.x=i.value.parentPosition.x+u.value.x,z.value.parentPosition.y=i.value.parentPosition.y+u.value.y,h.value&&(S.value.x=h.value.offsetWidth+(v.value.xOffset||0));const r=n.target;r&&(S.value.y=r.offsetTop+(v.value.yOffset||0))}function P(){m=d.value,setTimeout(()=>{m===d.value&&(d.value=null)})}H(d,(n,e)=>{n&&e&&setTimeout(()=>{b.value&&b.value.doCheckPos()},50)});function R(n){P(),n&&o("close",!0)}function A(n){m===n&&(m=null),o("keepOpen",a.value)}function V(n){S.value.x=n.x,S.value.y=n.y}function Z(n){n.disabled||(typeof n.onClick=="function"?(n.onClick(),o("close",!0)):(!n.children||n.children.length===0)&&o("close",!0))}function G(){o("keepOpen",a.value)}function q(n){n.relatedTarget!=null&&o("close",!1)}function $(n){h.value&&(h.value.scrollTop+=n?30:-30)}let k=0;function J(){const n=h.value,e=i.value;if(n){const r={x:u.value.x,y:u.value.y},s=e.parentPosition.x+u.value.x+n.offsetWidth;if(s>e.screenSize.w&&(r.x-=s-e.screenSize.w),n.offsetHeight>e.screenSize.h-30)g.value=e.screenSize.h-30,r.y=-e.parentPosition.y,w.value=!0;else{w.value=!1,g.value=0;const M=e.parentPosition.y+u.value.y+n.offsetHeight;M>e.screenSize.h&&(r.y-=M-e.screenSize.h+30)}o("preUpdatePos",r),c.value=!0}}return L(()=>{k=window.setTimeout(()=>J(),100)}),F(()=>{k>0&&(clearTimeout(k),k=0)}),(n,e)=>{const r=X("ContextSubMenu",!0);return t.items?(C(),_("div",{key:0,class:B("context-menu "+(l(v).customClass?l(v).customClass:"")+(c.value?" ready":"")),style:E({maxWidth:l(a)&&l(a).maxWidth?`${l(a).maxWidth}px`:"600px",minWidth:l(a)&&l(a).minWidth?`${l(a).minWidth}px`:"100px",zIndex:t.zIndex,left:`${l(u).x}px`,top:`${l(u).y}px`}),onMouseenter:G,onMouseleave:e[4]||(e[4]=s=>q(s))},[D(x("div",{class:"context-menu-updown up",onClick:e[0]||(e[0]=s=>$(!1))},ie,512),[[T,w.value]]),D(x("div",{class:"context-menu-updown down",onClick:e[1]||(e[1]=s=>$(!0))},ce,512),[[T,w.value]]),x("div",{class:"context-menu-items",ref_key:"menu",ref:h,style:E({maxHeight:g.value>0?`${g.value}px`:""})},[(C(!0),_(Y,null,ee(t.items,(s,M)=>(C(),_("div",{key:M,class:B(["context-menu-item",{disabled:s.disabled}]),onMouseenter:y=>W(y,s),onMouseleave:e[2]||(e[2]=y=>P()),onFocus:y=>W(y,s),onBlur:e[3]||(e[3]=y=>P()),onClick:y=>Z(s)},[x("span",re,[x("span",null,ne(s.label),1),s.children&&s.children.length>0?(C(),_("span",pe)):I("",!0)])],42,de))),128))],4),d.value&&d.value.children?(C(),N(r,{key:0,ref_key:"childMenu",ref:b,zIndex:t.zIndex+1,items:d.value.children,parentItem:d.value,options:l(v),globalData:z.value,position:S.value,onClose:R,onKeepOpen:A,onPreUpdatePos:V},null,8,["zIndex","items","parentItem","options","globalData","position"])):I("",!0)],38)):I("",!0)}}});const ve=se(fe,[["__scopeId","data-v-e2959c42"]]),O={defaultMinWidth:100,defaultMaxWidth:600,defaultStartZindex:1},he=U({__name:"ContextMenu",props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},emits:["update:show","close"],setup(t,{emit:o}){const f=t,i=p({x:0,y:0}),u={parentPosition:{x:0,y:0},screenSize:{w:window.innerWidth,h:window.innerHeight}};function v(){i.value.x=f.options.x,i.value.y=f.options.y}function a(){o("update:show",!1),o("close")}function h(c){c&&a()}function b(c){i.value.x=c.x,i.value.y=c.y}return L(()=>{v(),setTimeout(()=>{document.addEventListener("click",a),document.addEventListener("contextmenu",a)},100)}),F(()=>{document.removeEventListener("click",a)}),H(()=>f.show,c=>{c&&v()}),(c,w)=>{const m=ve;return t.show?(C(),N(m,{key:0,items:t.options.items,parentItem:{maxWidth:t.options.maxWidth||l(O).defaultMaxWidth,minWidth:t.options.minWidth||l(O).defaultMinWidth},options:t.options,"z-index":t.options.zIndex||l(O).defaultStartZindex,globalData:u,position:i.value,"on-close":h,"on-pre-update-pos":b},null,8,["items","parentItem","options","z-index","position"])):I("",!0)}}}),me=t=>{const o=document.createElement("div"),f=le(he,{options:t,show:!0,onClose:()=>{j(null,o)}});return j(f,o),document.body.appendChild(o.firstElementChild),f.component};export{me as c};
