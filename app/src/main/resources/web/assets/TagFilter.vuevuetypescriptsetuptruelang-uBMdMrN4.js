import{_ as N}from"./more-vert-De1QBMLo.js";import{o as i,c as l,a as t,d as E,g as z,u as F,h as m,l as P,C as j,b2 as O,aX as U,a1 as s,aY as X,S as Y,p as v,t as r,x as k,w as g,O as q,P as Z,N as x,Z as h,j as M,c9 as J,ca as K,ad as R,cb as W,a7 as ee,f as te,cc as ne,a8 as ae,a2 as oe}from"./index-Dn0O6zoH.js";import{E as w}from"./EditValueModal-Du2st8tU.js";const se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ie=t("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1),le=[ie];function de(p,o){return i(),l("svg",se,[...le])}const ce={name:"material-symbols-add-rounded",render:de},re={class:"top-app-bar"},ue={class:"btn-icon no-click"},pe={class:"title"},_e={class:"actions"},me=t("md-ripple",null,null,-1),ve={class:"nav"},ge=["onClick"],he={class:"title"},fe=["id","onClick"],ye=t("md-ripple",null,null,-1),be={class:"count"},Te=["anchor","open"],$e={slot:"headline"},Ce={slot:"headline"},we=E({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(p){const o=p,{t:d}=z(),S=F(),f=m([]),_=m(!1),u=m(),{refetch:c}=P({handle:(e,n)=>{n?j(d(n),"error"):e&&(f.value=e.tags)},document:O,variables:{type:o.type},appApi:!0});function V(e){u.value=e,_.value=!0}function D(e){h(w,{title:d("rename"),placeholder:d("name"),value:e.name,mutation:()=>M({document:J,appApi:!0}),getVariables:n=>({id:e.id,name:n}),done:()=>{c()}})}function L(e){h(R,{id:e.id,name:e.name,gql:K,appApi:!0,typeName:"Tag"})}function Q(){h(w,{title:d("add_tag"),placeholder:d("name"),mutation:()=>M({document:W,options:{update:()=>{c()}},appApi:!0}),getVariables:e=>({type:o.type,name:e})})}function B(e){const n=ee([{name:"tag_id",op:"",value:e.id}]);te(S,`/${ne[o.type]}?q=${ae(n)}`)}const y=e=>{e===o.type&&c()},b=e=>{e.type===o.type&&c()},T=e=>{e.item.tags.length&&e.type===o.type&&c()};return U(()=>{s.on("refetch_tags",y),s.on("media_items_deleted",b),s.on("media_item_deleted",T)}),X(()=>{s.off("refetch_tags",y),s.off("media_items_deleted",b),s.off("media_item_deleted",T)}),(e,n)=>{var C;const A=oe,G=ce,H=N,$=Y("tooltip");return i(),l(q,null,[t("div",re,[t("div",ue,[v(A)]),t("div",pe,r(e.$t("tags")),1),t("div",_e,[k((i(),l("button",{class:"btn-icon",onClick:g(Q,["prevent"])},[me,v(G)])),[[$,e.$t("add_tag")]])])]),t("ul",ve,[(i(!0),l(q,null,Z(f.value,a=>(i(),l("li",{onClick:g(I=>B(a),["prevent"]),key:a.id,class:x({active:a.id===p.selected})},[t("span",he,r(a.name),1),k((i(),l("button",{id:"tag-"+a.id,class:"btn-icon sm",onClick:g(I=>V(a),["prevent","stop"])},[ye,v(H)],8,fe)),[[$,e.$t("actions")]]),t("span",be,r(a.count.toLocaleString()),1)],10,ge))),128))]),t("md-menu",{positioning:"popover",anchor:"tag-"+((C=u.value)==null?void 0:C.id),"stay-open-on-focusout":"",quick:"",open:_.value,onClosed:n[2]||(n[2]=a=>_.value=!1)},[t("md-menu-item",{onClick:n[0]||(n[0]=a=>D(u.value))},[t("div",$e,r(e.$t("rename")),1)]),t("md-menu-item",{onClick:n[1]||(n[1]=a=>L(u.value))},[t("div",Ce,r(e.$t("delete")),1)])],40,Te)],64)}}});export{we as _,ce as a};
