import{_ as K}from"./TagFilter.vuevuetypescriptsetuptruelang-48aecefe.js";import{d as L,r as M,bM as U,N as A,o as f,c as b,e as a,g as d,w as q,F as S,A as B,ae as I,Z as C,c0 as Y,ac as Z,G as H,ad as J,U as W,y as F,R as X,P as ee,j as t,O as te,u as se,q as R,p as O,i as ae,t as Q,c1 as ne,a1 as D,c2 as oe,c3 as ie,c4 as le,c5 as re,k as ce,f as y,z as P,bw as G,E as de,B as V,V as ue,c6 as pe,v as me,c7 as _e,x as fe}from"./index-cf22a9d8.js";import{_ as ve}from"./EditValueModal.vuevuetypescriptsetuptruelang-5fd4f7ed.js";import{c as he}from"./index-a6eeb602.js";import{_ as ye}from"./DeleteConfirm.vuevuetypescriptsetuptruelang-1943d7a1.js";import{_ as be}from"./VModal.vuevuetypescriptsetuptruelang-83ac7574.js";import{u as ke,a as $e}from"./vee-validate.esm-dd3b5249.js";import{g as T,M as xe}from"./splitpanes.es-dd05a209.js";const ge={class:"dropdown"},we={class:"dropdown-menu"},Fe=["onClick"],Ce=L({__name:"Dropdown",props:{title:{type:String,required:!0},items:{type:Array,required:!0,default:()=>[]}},setup(r){const e=M(!1);return(v,i)=>{const l=U("click-away");return A((f(),b("div",ge,[a("button",{class:"btn dropdown-toggle",type:"button",onClick:i[0]||(i[0]=q(()=>e.value=!e.value,["prevent"]))},d(r.title),1),A(a("ul",we,[(f(!0),b(S,null,B(r.items,(u,p)=>(f(),b("li",{key:p},[a("a",{class:"dropdown-item",href:"#",onClick:q(()=>{e.value=!1,u.click()},["prevent"])},d(u.text),9,Fe)]))),128))],512),[[I,e.value]])])),[[l,()=>e.value=!1]])}}}),Me={class:"mb-4"},Ae=["placeholder"],qe=["disabled"],Le=L({__name:"FeedModal",props:{data:{type:Object}},setup(r){var k;const e=r,{handleSubmit:v}=ke(),i=M(),{mutate:l,loading:u,onDone:p}=C({document:Y,appApi:!0}),{value:c,errorMessage:h}=$e("inputValue",Z().required());c.value=((k=e.data)==null?void 0:k.name)??"",(async()=>{var n;await H(),(n=i.value)==null||n.focus()})();const m=v(()=>{var n;l({id:(n=e.data)==null?void 0:n.id,name:c.value})});return p(()=>{J()}),(n,_)=>{const N=be;return f(),W(N,{title:n.$t("update_subscription")},{body:F(()=>{var $;return[a("div",Me,d(($=r.data)==null?void 0:$.url),1),a("div",null,[A(a("input",{ref_key:"input",ref:i,type:"text",placeholder:n.$t("name"),class:"form-control","onUpdate:modelValue":_[0]||(_[0]=x=>X(c)?c.value=x:null),onKeyup:_[1]||(_[1]=ee((...x)=>t(m)&&t(m)(...x),["enter"]))},null,40,Ae),[[te,t(c)]]),A(a("div",{class:"invalid-feedback"},d(t(h)?n.$t(t(h)):""),513),[[I,t(h)]])])]}),action:F(()=>[a("button",{type:"button",disabled:t(u),class:"btn",onClick:_[2]||(_[2]=(...$)=>t(m)&&t(m)(...$))},d(n.$t("save")),9,qe)]),_:1},8,["title"])}}}),Ne={class:"nav-title mt-4"},De={class:"nav"},Se=["onClick","onContextmenu"],Ve=L({__name:"FeedFilter",props:{selected:{type:String,required:!0}},setup(r){const{t:e}=se(),v=R(),i=M([]),l=M(),u=O(),p=[{text:e("add_subscription"),click:m},{text:e("import_opml_file"),click:$},{text:e("export_opml_file"),click:x}],{refetch:c}=ae({handle:(s,o)=>{o?Q(e(o),"error"):s&&(i.value=s.feeds)},document:ne,appApi:!0});function h(s){const o=s.target.files;if(!o)return;const g=new FileReader;g.addEventListener("load",()=>{_({content:g.result})},!1),g.readAsText(o[0])}function m(){D(ve,{title:e("add_subscription"),placeholder:e("rss_url"),mutation:()=>C({document:oe,options:{update:()=>{c()}},appApi:!0}),getVariables:s=>({url:s})})}const{mutate:k,onDone:n}=C({document:ie,appApi:!0});n(s=>{le(s.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:_,onDone:N}=C({document:re,appApi:!0});N(()=>{Q(e("imported")),c()});function $(){l.value.value="",l.value.click()}function x(){k()}function z(s){const o=de([{name:"feed",op:"",value:G(s.name)}]);V(v,`/feeds?q=${ue(o)}`)}function j(s,o){s.preventDefault(),he({x:s.x,y:s.y,items:[{label:e("edit"),onClick:()=>{D(Le,{data:o})}},{label:e("delete"),onClick:()=>{D(ye,{id:o.id,name:o.name,gql:pe,appApi:!0,typeName:"Feed",done:()=>{V(v,"/feeds")}})}}]})}return(s,o)=>{const g=Ce;return f(),b(S,null,[a("h2",Ne,[ce(d(s.$t("subscriptions"))+" ",1),y(g,{class:"dropdown-sm",title:s.$t("add"),items:p},null,8,["title"])]),a("ul",De,[(f(!0),b(S,null,B(i.value,w=>(f(),b("li",{onClick:q(E=>z(w),["prevent"]),onContextmenu:E=>j(E,w),class:P({active:t(u).params.feedId===w.id||r.selected&&t(G)(w.name)===r.selected})},d(w.name),43,Se))),256))]),a("input",{ref_key:"fileInput",ref:l,style:{display:"none"},accept:".xml",type:"file",onChange:h},null,544)],64)}}}),Ee={class:"page-container container-fluid"},Qe={class:"sidebar"},Ge={class:"nav-title"},Te={class:"nav"},Be=["onClick"],Ie={class:"main"},Re={name:"FeedsRoot",inheritAttrs:!1,customOptions:{}},He=L({...Re,setup(r){const e=O(),v=R(),i=me(e.query),l=_e(e.query);function u(){V(v,"/feeds")}return(p,c)=>{const h=Ve,m=K,k=fe("router-view");return f(),b("div",Ee,[y(t(xe),null,{default:F(()=>[y(t(T),{size:"20"},{default:F(()=>[a("div",Qe,[a("h2",Ge,d(p.$t("page_title.feeds")),1),a("ul",Te,[a("li",{onClick:q(u,["prevent"]),class:P({active:t(e).path==="/feeds"&&!t(i)&&!t(l)})},d(p.$t("all")),11,Be)]),y(h,{selected:t(l)},null,8,["selected"]),y(m,{"tag-type":"FEED_ENTRY",selected:t(i)},null,8,["selected"])])]),_:1}),y(t(T),null,{default:F(()=>[a("div",Ie,[y(k)])]),_:1})]),_:1})])}}});export{He as default};
