import{u as kt,_ as wt,a as $t}from"./list-ecca0f33.js";import{_ as Vt}from"./FieldId-7a42c5ae.js";import{_ as Ct}from"./Multiselect-6a97b930.js";import{_ as Tt,a as It}from"./grid-view-outline-rounded-4254504d.js";import{_ as St,a as Rt}from"./label-outline-rounded-f959da46.js";import{_ as Et}from"./download-rounded-2da2fb73.js";import{_ as Ut}from"./delete-outline-rounded-fee50069.js";import{_ as qt}from"./Breadcrumb-d5bdebe4.js";import{d as zt,aq as At,q as Dt,r as b,u as Ft,a as Bt,s as Mt,C as Nt,H as Y,p as Lt,D as Qt,E as Kt,G as Gt,a4 as Ot,an as Z,ar as Wt,I as Pt,t as Xt,as as jt,au as xt,K as tt,L as Ht,M as Jt,o as l,c as u,e as t,f as r,j as s,F as f,w as d,l as _,U as q,g as a,y as Yt,N as z,O as Zt,P as te,A,a0 as et,Q as ot,R as ee,z as oe,m as se,W as ne,B as st,V as nt,ai as le,aa as ae,ab as ie,_ as ue}from"./index-5f5c60b6.js";import{n as lt}from"./list-6498ebd9.js";import{u as ce,a as de,b as re}from"./tags-d534ff65.js";import{u as _e,_ as pe}from"./ConfirmModal.vuevuetypescriptsetuptruelang-27a0159b.js";import"./VModal.vuevuetypescriptsetuptruelang-61cd4dae.js";import"./vee-validate.esm-e0a551fe.js";const at=y=>(ae("data-v-aef9738d"),y=y(),ie(),y),me={class:"v-toolbar"},ve={class:"right-actions"},be=["title"],he=["title"],ge=["title"],fe=["title"],ye=["onClick"],ke=["onClick"],we={class:"row mb-3"},$e={class:"col-md-3 col-form-label"},Ve={class:"col-md-9"},Ce=["onKeyup"],Te={class:"row mb-3"},Ie={class:"col-md-3 col-form-label"},Se={class:"col-md-9"},Re={class:"actions"},Ee=["onClick"],Ue={key:0,class:"row row-cols-6 g-1",style:{"margin-bottom":"24px"}},qe=["onClick"],ze=["src"],Ae={class:"duration"},De={key:1,class:"no-data-placeholder"},Fe={key:2,class:"table"},Be=at(()=>t("th",null,"ID",-1)),Me=at(()=>t("th",null,null,-1)),Ne=["onClick"],Le=["onUpdate:modelValue"],Qe=["src","onClick"],Ke={class:"badge"},Ge={key:0},Oe={colspan:"7"},We={class:"no-data-placeholder"},Pe=zt({__name:"VideosView",setup(y){var x,H,J;const it=At(),D=Dt(),c=b([]),{t:F}=Ft(),B=Bt(),{app:C}=Mt(B),p=Nt({text:"",tags:[]}),ut=Y(()=>c.value.some(o=>o.checked)),h="VIDEO",T=Lt().query,g=b(parseInt(((x=T.page)==null?void 0:x.toString())??"1")),k=54,w=b(0),m=b(Qt(((H=T.q)==null?void 0:H.toString())??"")),M=b(""),{tags:I}=ce(h,m,p,async o=>{M.value=Kt(o),await Gt(),ct()}),i=b(((J=T.view)==null?void 0:J.toString())??"grid"),{addToTags:N}=de(h,c,I),{removeFromTags:L}=re(h,c,I),{deleteItems:Q}=_e(h,c),{downloadItems:K}=Ot(c,"videos.zip"),S=Y(()=>c.value.map(o=>({src:Z(o.fileId),name:Wt(o.path),duration:o.duration,size:o.size}))),{selectAll:R,toggleSelect:G}=kt(c),{loading:O,load:ct,refetch:dt}=Pt({handle:async(o,n)=>{if(n)Xt(F(n),"error");else if(o){const{fileIdToken:E}=C.value,$=[];for(const V of o.videos)$.push({...V,checked:!1,fileId:await jt(E,V.path)});c.value=$,w.value=o.videoCount}},document:xt,variables:()=>({offset:(g.value-1)*k,limit:k,query:M.value}),appApi:!0});function W(){st(D,`/videos?page=${g.value}&q=${nt(m.value)}&view=${i.value}`)}function P(o){B.lightbox={sources:S.value,index:o,visible:!0}}tt(g,()=>{W()}),tt(i,()=>{W()});function X(){m.value=ne(p),j()}function j(){st(D,`/videos?q=${nt(m.value)}&view=${i.value}`)}function rt(){i.value==="grid"?i.value="list":i.value="grid"}function _t(){it.push("/files"),le(pe,{message:F("upload_videos")})}return Ht(()=>{Jt.on("refetch_by_tag_type",o=>{o===h&&dt()})}),(o,n)=>{const E=qt,$=Ut,V=Et,pt=St,mt=Rt,vt=Tt,bt=It,ht=Ct,gt=wt,ft=Vt,yt=$t;return l(),u(f,null,[t("div",me,[r(E,{current:()=>`${o.$t("page_title.videos")} (${w.value})`},null,8,["current"]),t("div",ve,[s(ut)&&i.value==="list"?(l(),u(f,{key:0},[t("button",{type:"button",class:"btn btn-action",onClick:n[0]||(n[0]=d((...e)=>s(Q)&&s(Q)(...e),["stop"])),title:o.$t("delete")},[r($,{class:"bi"})],8,be),t("button",{type:"button",class:"btn btn-action",onClick:n[1]||(n[1]=d((...e)=>s(K)&&s(K)(...e),["stop"])),title:o.$t("download")},[r(V,{class:"bi"})],8,he),t("button",{type:"button",class:"btn btn-action",onClick:n[2]||(n[2]=d((...e)=>s(N)&&s(N)(...e),["stop"])),title:o.$t("add_to_tags")},[r(pt,{class:"bi"})],8,ge),t("button",{type:"button",class:"btn btn-action",onClick:n[3]||(n[3]=d((...e)=>s(L)&&s(L)(...e),["stop"])),title:o.$t("remove_from_tags")},[r(mt,{class:"bi"})],8,fe)],64)):_("",!0),t("button",{type:"button",class:"btn btn-action",onClick:d(rt,["prevent"])},[i.value==="list"?(l(),q(vt,{key:0,class:"bi"})):_("",!0),i.value==="grid"?(l(),q(bt,{key:1,class:"bi"})):_("",!0)],8,ye),t("button",{type:"button",class:"btn btn-action",onClick:d(_t,["prevent"])},a(o.$t("upload")),9,ke),r(gt,{modelValue:m.value,"onUpdate:modelValue":n[6]||(n[6]=e=>m.value=e),search:j},{filters:Yt(()=>[t("div",we,[t("label",$e,a(o.$t("keywords")),1),t("div",Ve,[z(t("input",{type:"text","onUpdate:modelValue":n[4]||(n[4]=e=>p.text=e),class:"form-control",onKeyup:te(X,["enter"])},null,40,Ce),[[Zt,p.text]])])]),t("div",Te,[t("label",Ie,a(o.$t("tags")),1),t("div",Se,[r(ht,{modelValue:p.tags,"onUpdate:modelValue":n[5]||(n[5]=e=>p.tags=e),label:"name","track-by":"id",options:s(I)},null,8,["modelValue","options"])])]),t("div",Re,[t("button",{type:"button",class:"btn",onClick:d(X,["stop"])},a(o.$t("search")),9,Ee)])]),_:1},8,["modelValue"])])]),i.value==="grid"?(l(),u("div",Ue,[(l(!0),u(f,null,A(s(S),(e,U)=>(l(),u("div",{class:"col",onClick:v=>P(U)},[t("img",{class:"image",src:e.src+"&w=200&h=200"},null,8,ze),t("span",Ae,a(s(et)(e.duration)),1)],8,qe))),256))])):_("",!0),i.value==="grid"&&s(S).length===0?(l(),u("div",De,a(o.$t(s(lt)(s(O),s(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):_("",!0),i.value==="list"?(l(),u("table",Fe,[t("thead",null,[t("tr",null,[t("th",null,[z(t("input",{class:"form-check-input",type:"checkbox",onChange:n[7]||(n[7]=(...e)=>s(G)&&s(G)(...e)),"onUpdate:modelValue":n[8]||(n[8]=e=>ee(R)?R.value=e:null)},null,544),[[ot,s(R)]])]),Be,Me,t("th",null,a(o.$t("name")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("duration")),1),t("th",null,a(o.$t("file_size")),1)])]),t("tbody",null,[(l(!0),u(f,null,A(c.value,(e,U)=>(l(),u("tr",{key:e.id,class:oe({checked:e.checked}),onClick:d(v=>e.checked=!e.checked,["stop"])},[t("td",null,[z(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":v=>e.checked=v},null,8,Le),[[ot,e.checked]])]),t("td",null,[r(ft,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("img",{class:"img-video",src:s(Z)(e.fileId)+"&w=200&h=200",width:"50",height:"50",onClick:d(v=>P(U),["stop"])},null,8,Qe)]),t("td",null,a(e.title),1),t("td",null,[(l(!0),u(f,null,A(e.tags,v=>(l(),u("span",Ke,a(v.name),1))),256))]),t("td",null,a(s(et)(e.duration)),1),t("td",null,a(s(se)(e.size)),1)],10,Ne))),128))]),c.value.length?_("",!0):(l(),u("tfoot",Ge,[t("tr",null,[t("td",Oe,[t("div",We,a(o.$t(s(lt)(s(O),s(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)])])]))])):_("",!0),w.value>k?(l(),q(yt,{key:3,modelValue:g.value,"onUpdate:modelValue":n[9]||(n[9]=e=>g.value=e),total:w.value,limit:k},null,8,["modelValue","total"])):_("",!0)],64)}}});const uo=ue(Pe,[["__scopeId","data-v-aef9738d"]]);export{uo as default};
