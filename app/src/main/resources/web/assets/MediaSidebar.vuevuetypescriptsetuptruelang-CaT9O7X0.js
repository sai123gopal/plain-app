import{_ as O}from"./LeftSidebar.vuevuetypescriptsetuptruelang-B6Ke7euJ.js";import{_ as w}from"./TagFilter.vuevuetypescriptsetuptruelang-uBMdMrN4.js";import{d as C,g as L,u as D,h as g,aH as N,l as T,C as Q,aW as x,aX as G,a1 as y,aY as H,o as h,c as I,P,w as A,m as B,N as V,a as _,t as f,O as R,s as U,i as z,I as F,aE as j,K as J,J as u,k as K,v as W,q as $,V as X,e as Y,p as q,a6 as b,a0 as Z,f as ee}from"./index-Dn0O6zoH.js";import{u as te}from"./search-DrT1IjAg.js";const ae=["onClick"],se={class:"title"},oe={class:"count"},ne=C({__name:"BucketFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(d){const e=d,{t:k}=L(),s=D(),v=g([]),{view:i}=N(e.type),{refetch:r}=T({handle:(a,p)=>{p?Q(k(p),"error"):a&&(v.value=a.mediaBuckets)},document:x,variables:{type:e.type},appApi:!0}),o=a=>{a.type===e.type&&r()},l=a=>{a.item.bucketId&&a.type===e.type&&r()};return G(()=>{y.on("media_items_deleted",o),y.on("media_item_deleted",l)}),H(()=>{y.off("media_items_deleted",o),y.off("media_item_deleted",l)}),(a,p)=>(h(!0),I(R,null,P(v.value,n=>(h(),I("li",{key:n.id,onClick:A(S=>B(i)(B(s),n.id),["prevent"]),class:V({active:d.selected&&n.id===d.selected})},[_("span",se,f(n.name),1),_("span",oe,f(n.itemCount.toLocaleString()),1)],10,ae))),128))}}),le={class:"nav"},ce={class:"title"},ie={key:0,class:"count"},me=C({__name:"MediaSidebar",props:{type:{type:String,required:!0},gql:{type:Object,required:!0}},setup(d){const e=d,k=D(),{counter:s}=U(z()),{parseQ:v}=te(),i=F({tagIds:[]}),r=g(""),o=g(""),l=g(""),a=j(()=>{var t,m,c;return e.type===u.IMAGE?((t=s.value)==null?void 0:t.images)??-1:e.type===u.VIDEO?((m=s.value)==null?void 0:m.videos)??-1:e.type===u.AUDIO?((c=s.value)==null?void 0:c.audios)??-1:-1}),{fetch:p}=J({handle:t=>{t&&(e.type===u.IMAGE?s.value.images=t.total:e.type===u.VIDEO?s.value.videos=t.total:e.type===u.AUDIO&&(s.value.audios=t.total))},document:e.gql,variables:()=>({}),appApi:!0});function n(){var c;const t=b.currentRoute.value;r.value=t.meta.group||"",p();const m=Z(((c=t.query.q)==null?void 0:c.toString())??"");v(i,m),o.value=i.tagIds.length===1?i.tagIds[0]:"",l.value=i.bucketId??"",o.value&&l.value&&(o.value="")}n(),K(()=>b.currentRoute.value.fullPath,()=>{n()});function S(){ee(k,`/${r.value}`)}return(t,m)=>{const c=ne,E=w,M=O;return h(),W(M,null,{title:$(()=>[X(f(t.$t(`page_title.${r.value}`)),1)]),body:$(()=>[_("ul",le,[_("li",{onClick:A(S,["prevent"]),class:V({active:!o.value&&!l.value})},[_("span",ce,f(t.$t("all")),1),a.value>=0?(h(),I("span",ie,f(a.value.toLocaleString()),1)):Y("",!0)],2),q(c,{type:e.type,selected:l.value},null,8,["type","selected"])]),q(E,{type:e.type,selected:o.value},null,8,["type","selected"])]),_:1})}}});export{me as _};
