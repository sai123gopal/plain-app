import{o,c as n,a as e,d as P,g as j,h as b,l as W,C as A,bS as le,j as D,bT as ie,av as E,t as i,O as I,P as N,x as p,y as x,m as r,e as H,V as C,H as Y,L as re,M as ce,p as w,aL as ue,bU as de,Z as _e,bV as ve,bW as me,bX as pe,bY as he,S as fe,bZ as ge,F as be,G as $e,a1 as Q}from"./index-R8dLcqG_.js";import{_ as ye}from"./refresh-rounded-D8TYDVGT.js";const qe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Te=e("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1),Me=[Te];function Se($,d){return o(),n("svg",qe,[...Me])}const ke={name:"material-symbols-fullscreen-exit-rounded",render:Se},we={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=e("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1),Ie=[Ce];function Le($,d){return o(),n("svg",we,[...Ie])}const Ve={name:"material-symbols-fullscreen-rounded",render:Le},ze={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"},Qe=e("path",{d:"M470.49 0H229.51a41.901 41.901 0 0 0-29.547 12.277 41.898 41.898 0 0 0-12.277 29.547v476.35a41.901 41.901 0 0 0 12.277 29.547 41.898 41.898 0 0 0 29.547 12.277h240.98a41.901 41.901 0 0 0 29.547-12.277 41.898 41.898 0 0 0 12.277-29.547V41.824a41.901 41.901 0 0 0-12.277-29.547A41.898 41.898 0 0 0 470.49 0zm33.25 518.18a33.334 33.334 0 0 1-9.766 23.484 33.335 33.335 0 0 1-23.484 9.766H229.51a33.334 33.334 0 0 1-23.484-9.766 33.335 33.335 0 0 1-9.765-23.484V41.83a33.333 33.333 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.334 33.334 0 0 1 23.484 9.765 33.335 33.335 0 0 1 9.765 23.484z"},null,-1),Ae=e("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375zM364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.453 16.453 0 0 0 0 16.977 16.584 16.584 0 0 0 6.101 6.386 16.653 16.653 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.803 16.803 0 0 0 0-16.977zm83.562 170.36a8.224 8.224 0 0 1-7.262 4.2H258.91a8.229 8.229 0 0 1-7.176-4.2 8.753 8.753 0 0 1 0-8.75l91-157.5a8.748 8.748 0 0 1 7.262-4.113 8.757 8.757 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),De=e("path",{d:"M350 221.55a4.288 4.288 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285zm0 91.26a4.289 4.289 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29z"},null,-1),He=[Qe,Ae,De];function Be($,d){return o(),n("svg",ze,[...He])}const Fe={render:Be},Ge={slot:"headline"},Ue={slot:"content"},Ee={class:"form-row"},Ne=["data-value","label","selected"],Oe={class:"form-row"},Re={class:"form-label"},xe=["disabled"],Pe=["value"],je={slot:"headline"},We={class:"form-row"},Ye={class:"form-label"},Ze=["disabled"],Xe=["value"],Je={slot:"headline"},Ke={class:"form-row"},et={slot:"actions"},tt=["disabled"],st={key:0,indeterminate:"",slot:"icon"},ot=P({__name:"ChangeScreenMirrorQualityModal",setup($){const{t:d}=j(),v=b(720),c=b(60),_=b("quality_sd"),m=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],h=[10,20,30,40,50,60,70,80,90,100],T=[480,720,1080];W({handle:(a,u)=>{var s;u?A(d(u),"error"):a&&(v.value=a.screenMirrorQuality.resolution,c.value=a.screenMirrorQuality.quality,_.value=((s=m.find(g=>{var M,z;return((M=g.data)==null?void 0:M.resolution)===v.value&&((z=g.data)==null?void 0:z.quality)===c.value}))==null?void 0:s.id)||"custom")},document:le,appApi:!0});function k(a){return a===10?`10 (${d("low_quality")})`:a===60?`60 (${d("high_quality")})`:a===100?`100 (${d("best_quality")})`:a.toString()}function L(a){const{button:u}=a.detail,s=u.dataset.value;_.value=s;const g=m.find(M=>M.id===s);g&&g.data&&(v.value=g.data.resolution,c.value=g.data.quality)}const{mutate:f,loading:V,onDone:F}=D({document:ie,appApi:!0});F(()=>{E()});const G=()=>{f({resolution:v.value,quality:c.value})};return(a,u)=>(o(),n("md-dialog",null,[e("div",Ge,i(a.$t("change_quality")),1),e("div",Ue,[e("div",Ee,[e("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:L},[(o(),n(I,null,N(m,s=>e("md-outlined-segmented-button",{key:s.id,"data-value":s.id,label:a.$t(s.id),selected:_.value===s.id},null,8,Ne)),64))],32)]),e("div",Oe,[e("label",Re,i(a.$t("compress_quality")),1),p(e("md-outlined-select",{class:"flex-2","menu-positioning":"fixed","onUpdate:modelValue":u[0]||(u[0]=s=>c.value=s),disabled:_.value!=="custom"},[(o(),n(I,null,N(h,s=>e("md-select-option",{key:s,value:s},[e("div",je,i(k(s)),1)],8,Pe)),64))],8,xe),[[x,c.value,void 0,{number:!0}]])]),e("div",We,[e("label",Ye,i(a.$t("resolution")),1),p(e("md-outlined-select",{class:"flex-2","menu-positioning":"fixed","onUpdate:modelValue":u[1]||(u[1]=s=>v.value=s),disabled:_.value!=="custom"},[(o(),n(I,null,N(T,s=>e("md-select-option",{key:s,value:s},[e("div",Je,i(s)+"p",1)],8,Xe)),64))],8,Ze),[[x,v.value,void 0,{number:!0}]])]),e("div",Ke,i(a.$t("screen_mirror_quality_tips")),1)]),e("div",et,[e("md-outlined-button",{value:"cancel",onClick:u[2]||(u[2]=(...s)=>r(E)&&r(E)(...s))},i(a.$t("cancel")),1),e("md-filled-button",{value:"save",disabled:r(V),onClick:G,autofocus:""},[r(V)?(o(),n("md-circular-progress",st)):H("",!0),C(" "+i(a.$t("save")),1)],8,tt)])]))}}),nt=Y(ot,[["__scopeId","data-v-4f617088"]]),B=$=>(be("data-v-b208b784"),$=$(),$e(),$),at={class:"screen-mirror"},lt={class:"top-app-bar"},it={class:"title"},rt={class:"actions"},ct=B(()=>e("md-ripple",null,null,-1)),ut=["disabled"],dt=B(()=>e("md-ripple",null,null,-1)),_t=B(()=>e("md-ripple",null,null,-1)),vt={class:"content"},mt={key:0},pt=B(()=>e("md-circular-progress",{indeterminate:""},null,-1)),ht=[pt],ft={key:0,class:"request-permission"},gt={class:"tap-phone"},bt={class:"text"},$t={key:1,class:"request-permission-failed"},yt=P({__name:"ScreenMirrorView",setup($){let d;const{t:v}=j(),c=b(!1),_=b(0),m=b(!1),h=b(!1),T=b(!1),k=b(),L=async t=>{c.value=!0,g(t),m.value=!1,_.value=0,clearInterval(d)};let f=!1;const{mutate:V}=D({document:de,appApi:!0}),F=()=>{h.value=!h.value,h.value||O()},G=()=>{_e(nt)},a=()=>{V(),f=!0},u=t=>{t&&f&&(f=!1,clearInterval(d),U())},s=()=>{const t=k.value;if(!t)return;const l=new Date,S="screenshot-"+[l.getFullYear(),l.getMonth()+1,l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds()].join("")+".png";ve(t.toDataURL(),S)};function g(t){const l=k.value;if(!l||h.value&&!T.value)return;T.value=!1;const S=l.getContext("2d"),y=new Image;y.src=URL.createObjectURL(t),y.onload=function(){S&&(l.width=y.width,l.height=y.height,S.drawImage(y,0,0))}}re(()=>{Q.on("screen_mirroring",L),Q.on("app_socket_connection_changed",u)}),ce(()=>{Q.off("screen_mirroring",L),Q.off("app_socket_connection_changed",u)});const{mutate:M,loading:z,onDone:Z,onError:X}=D({document:me,appApi:!0}),{loading:J,refetch:O}=W({handle:(t,l)=>{l?A(v(l),"error"):t.screenMirrorState?(c.value=!0,T.value=!0):(c.value=!1,T.value=!1,U())},options:{fetchPolicy:"no-cache"},document:pe,appApi:!0}),K=()=>{document.getElementsByClassName("screen-mirror")[0].requestFullscreen({navigationUI:"show"})},U=()=>{m.value=!1,h.value=!1,M()},ee=()=>{document.exitFullscreen()};X(t=>{A(v(t.message)),m.value=!0}),Z(()=>{_.value=30,d=setInterval(()=>{_.value--,_.value<=0&&(m.value=!0,clearInterval(d))},1e3)});const{mutate:R,loading:te,onDone:se,onError:oe}=D({document:he,appApi:!0});return oe(t=>{A(v(t.message))}),se(()=>{m.value=!0,c.value=!1}),(t,l)=>{const S=ye,y=Ve,ne=ke,q=fe("tooltip");return o(),n("div",at,[e("div",lt,[e("div",it,i(t.$t("screen_mirror")),1),e("div",rt,[c.value?(o(),n(I,{key:0},[p((o(),n("button",{class:"btn-icon",onClick:l[0]||(l[0]=()=>r(O)())},[ct,w(S)])),[[q,t.$t("refresh")]]),p((o(),n("md-outlined-button",{onClick:G,class:"btn-sm"},[C(i(t.$t("mirror_quality")),1)])),[[q,t.$t("change_quality")]]),p((o(),n("md-outlined-button",{onClick:s,class:"btn-sm"},[C(i(t.$t("screenshot")),1)])),[[q,t.$t("screenshot")]]),p((o(),n("md-outlined-button",{onClick:F,class:"btn-sm"},[C(i(t.$t(h.value?"resume":"pause")),1)])),[[q,t.$t(h.value?"resume":"pause")]]),p((o(),n("md-outlined-button",{disabled:r(te),onClick:l[1]||(l[1]=(...ae)=>r(R)&&r(R)(...ae)),class:"btn-sm btn-stop"},[C(i(t.$t("stop_mirror")),1)],8,ut)),[[q,t.$t("stop_mirror")]]),p((o(),n("button",{class:"btn-icon btn-enter-fullscreen",onClick:K},[dt,w(y)])),[[q,t.$t("fullscreen")]]),p((o(),n("button",{class:"btn-icon btn-exit-fullscreen",onClick:ee},[_t,w(ne)])),[[q,t.$t("exit_fullscreen")]])],64)):r(f)?H("",!0):(o(),n("md-outlined-button",{key:1,class:"btn-sm",onClick:a},i(t.$t("relaunch_app")),1))])]),e("div",vt,[r(J)||r(z)||r(f)?(o(),n("div",mt,ht)):(o(),n(I,{key:1},[_.value>0&&!r(f)?(o(),n("div",ft,[e("div",gt,[w(r(ge))]),e("pre",bt,i(t.$t("screen_mirror_request_permission",{seconds:_.value})),1)])):H("",!0),m.value&&!c.value&&!r(f)?(o(),n("div",$t,[w(r(Fe)),e("p",null,i(t.$t("screen_mirror_request_permission_failed")),1),e("md-filled-button",{onClick:U},i(t.$t("try_again")),1)])):H("",!0),p(e("canvas",{ref_key:"canvasRef",ref:k,class:"canvas"},null,512),[[ue,c.value]])],64))])])}}}),Mt=Y(yt,[["__scopeId","data-v-b208b784"]]);export{Mt as default};
