import{_ as Ge}from"./more-vert-zjmMMiPD.js";import{g as _e,h as S,K as pe,C as D,cK as Ke,d as xe,u as He,s as We,i as Pe,I as je,J as Oe,aH as ne,j as le,L as Ye,M as Je,c as l,a as t,m as e,t as v,O as ce,x as E,w as m,p as r,e as A,P as Xe,v as Ze,q as ie,n as es,Q as ss,a1 as h,cL as ts,cM as os,cN as as,cO as ns,S as ls,o as a,N as cs,U as is,V as ds,W as rs,aC as us,bj as _s,X as ps,F as vs,G as ms,Y as hs,a6 as de,ch as fs,f as re,a0 as gs,ae as ks,a2 as ys,a3 as bs,a4 as ws,H as Ss}from"./index-R8dLcqG_.js";import{_ as $s,a as Cs}from"./SearchInput-DhaE-3h8.js";import{_ as Ts,a as Ls}from"./add-notes-outline-rounded-CJxyoeFp.js";import{u as Is}from"./feeds-bp5iUXJ_.js";import{u as qs,b as Fs,a as Es}from"./key-events-BNCM8SMB.js";import{a as As}from"./tags-Dbpv368M.js";import{u as Ds}from"./search-ByVbj6Ls.js";import"./search-rounded-CULEMJ2O.js";import"./rss-feed-rounded-BCiGdgJ5.js";import"./vee-validate.esm-vpr6zxQb.js";const Ms=(u,_,$)=>{const{t:C}=_e(),g=S(1),M=100,i=S(!1),{loading:T,fetch:Q}=pe({handle:(k,L)=>{if(L)D(C(L),"error");else if(k){k.items.length<M&&(i.value=!0);const I=k.items;g.value===1?u.value=I:u.value=u.value.concat(I),$.value=k.total}},document:Ke,variables:()=>({offset:(g.value-1)*M,limit:M,query:_.value}),appApi:!0});return{page:g,noMore:i,loading:T,fetch:Q,loadMore:()=>{i.value||T.value||g.value++}}},f=u=>(vs("data-v-c75d0d53"),u=u(),ms(),u),Ns={class:"top-app-bar"},Qs=["checked","indeterminate"],Us={class:"title"},Vs={key:0},Rs={key:1},zs=f(()=>t("md-ripple",null,null,-1)),Bs=f(()=>t("md-ripple",null,null,-1)),Gs={key:0,indeterminate:"",class:"spinner-sm"},Ks=f(()=>t("md-ripple",null,null,-1)),xs={class:"actions"},Hs={key:0,indeterminate:"",class:"spinner-sm"},Ws=["disabled"],Ps=f(()=>t("md-ripple",null,null,-1)),js={key:0,class:"scroller"},Os=hs('<div class="title" data-v-c75d0d53><div class="checkbox" data-v-c75d0d53><div class="skeleton-checkbox" data-v-c75d0d53></div></div><div class="text" data-v-c75d0d53><div class="skeleton-text skeleton-title" data-v-c75d0d53></div></div></div>',1),Ys={class:"subtitle"},Js={class:"number"},Xs=f(()=>t("div",{class:"info"},[t("div",{class:"skeleton-text skeleton-info"})],-1)),Zs=f(()=>t("div",{class:"image"},[t("div",{class:"skeleton-image"})],-1)),et=["href"],st=["onClick","onMouseover"],tt={class:"title"},ot=["onClick","checked"],at=["onClick","checked"],nt={class:"text"},lt={class:"subtitle"},ct={class:"number"},it={class:"info"},dt=["onClick"],rt=f(()=>t("span",null,"Â·",-1)),ut={class:"time"},_t={class:"btn-icon sm",style:{display:"none"}},pt=f(()=>t("md-ripple",null,null,-1)),vt=["src"],mt={key:0,indeterminate:"",class:"spinner-sm"},ht={key:2,class:"no-data-placeholder"},ue=100,ft=xe({__name:"FeedsSidebar2",setup(u){var oe;const _=He(),{feedsSyncing:$}=We(Pe()),{t:C}=_e(),g=je({tagIds:[]}),{parseQ:M}=Ds(),i=Oe.FEED_ENTRY,T=ss(),Q=T.query,k=S(parseInt(((oe=Q.page)==null?void 0:oe.toString())??"1")),L=S([]),I=S([]),z=ne(()=>{const s={};return I.value.forEach(o=>{s[o.id]=o}),s}),y=S([]),b=S(""),{selectedIds:d,allChecked:B,realAllChecked:q,selectRealAll:ve,allCheckedAlertVisible:me,clearSelection:U,toggleAllChecked:G,toggleSelect:K,total:w,checked:x,shiftEffectingIds:H,handleItemClick:he,handleMouseOver:fe,selectAll:ge,shouldSelect:ke}=qs(y),ye=s=>{k.value=s;const o=T.query.q;re(_,o?`/feeds?page=${s}&q=${o}`:`/feeds?page=${s}`)},{keyDown:W,keyUp:P}=Es(w,ue,k,ge,U,ye,()=>{Y(d.value,q.value,w.value,b.value)}),{page:j,loading:R,loadMore:be,fetch:we,noMore:O}=Ms(y,b,w),{addToTags:Se}=As(i,L),N=()=>{j.value=1,we()},{deleteItems:Y}=Fs(ts,()=>{U(),N(),y.value.some(s=>s.tags.length)&&h.emit("refetch_tags",i),h.emit("feed_entries_deleted")}),$e=ne(()=>de.currentRoute.value.path!=="/feeds"),{resizeWidth:J}=fs(300,()=>_.sidebar2Width,s=>{_.sidebar2Width=s}),{mutate:X,loading:Ce,onDone:Te}=le({document:os,appApi:!0});function Le(){if(q)X({query:b.value});else{if(d.value.length===0){D(C("select_first"),"error");return}X({query:`ids:${d.value.join(",")}`})}}Te(()=>{D(C("saved"))});function Ie(s){return s?`/feeds?q=${s}`:"/feeds"}const{fetch:qe}=pe({handle:async(s,o)=>{o?D(C(o),"error"):s&&(L.value=s.tags,I.value=s.feeds)},document:as,variables:{type:i},appApi:!0});function Z(s){const o=de.currentRoute.value.query.q;return o?`/feeds/${s.feedId}/entries/${s.id}?q=${o}`:`/feeds/${s.feedId}/entries/${s.id}`}function Fe(s){re(_,Z(s))}const{viewFeed:Ee}=Is(_),{mutate:Ae}=le({document:ns,appApi:!0});function De(){$.value=!0,Ae({id:""})}const ee=s=>{$.value=!1,N(),s.error?D(s.error,"error"):D(C("feeds_synced"))},se=s=>{s.type===i&&(U(),N())},te=s=>{s.type===i&&N()};return Ye(()=>{var o,V;const s=(o=document.getElementsByClassName("scroller"))==null?void 0:o[0];s&&(s.scrollTop=0),b.value=gs(((V=Q.q)==null?void 0:V.toString())??""),M(g,b.value),qe(),N(),h.on("item_tags_updated",te),h.on("items_tags_updated",se),h.on("feeds_fetched",ee),window.addEventListener("keydown",W),window.addEventListener("keyup",P)}),Je(()=>{j.value=1,O.value=!1,h.off("item_tags_updated",te),h.off("items_tags_updated",se),h.off("feeds_fetched",ee),window.removeEventListener("keydown",W),window.removeEventListener("keyup",P)}),(s,o)=>{const V=ks,Me=ys,Ne=Ts,Qe=$s,Ue=Ls,Ve=Cs,Re=bs,ze=ws,Be=Ge,F=ls("tooltip");return a(),l("aside",{class:"sidebar2",style:es({width:e(T).params.id?e(_).sidebar2Width+"px":"auto"})},[t("div",Ns,[t("md-checkbox",{"touch-target":"wrapper",onChange:o[0]||(o[0]=(...c)=>e(G)&&e(G)(...c)),checked:e(B),indeterminate:!e(B)&&e(x)},null,40,Qs),t("div",Us,[e(d).length?(a(),l("span",Vs,v(s.$t("x_selected",{count:e(q)?e(w).toLocaleString():e(d).length.toLocaleString()})),1)):(a(),l("span",Rs,v(s.$t("page_title.feeds"))+" ("+v(e(w).toLocaleString())+")",1)),e(x)?(a(),l(ce,{key:2},[E((a(),l("button",{class:"btn-icon",onClick:o[1]||(o[1]=m(c=>e(Y)(e(d),e(q),e(w),b.value),["stop"]))},[zs,r(V)])),[[F,s.$t("delete")]]),E((a(),l("button",{class:"btn-icon",onClick:o[2]||(o[2]=m(c=>e(Se)(e(d),e(q),b.value),["stop"]))},[Bs,r(Me)])),[[F,s.$t("add_to_tags")]]),e(Ce)?(a(),l("md-circular-progress",Gs)):E((a(),l("button",{key:1,class:"btn-icon sm",onClick:m(Le,["prevent"])},[Ks,r(Ne)])),[[F,s.$t("save_to_notes")]])],64)):A("",!0)]),t("div",xs,[r(Qe,{filter:g,tags:L.value,feeds:I.value,"show-chips":!$e.value,"get-url":Ie,"show-today":!0},null,8,["filter","tags","feeds","show-chips"]),e($)?(a(),l("md-circular-progress",Hs)):E((a(),l("button",{key:1,class:"btn-icon",disabled:e($),onClick:m(De,["prevent"])},[Ps,r(Ue)],8,Ws)),[[F,s.$t("sync_feeds")]])])]),r(Ve,{limit:ue,total:e(w),"all-checked-alert-visible":e(me),"real-all-checked":e(q),"select-real-all":e(ve),"clear-selection":e(U)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),e(R)&&y.value.length===0?(a(),l("div",js,[(a(),l(ce,null,Xe(20,c=>t("section",{class:"feed-item selectable-card-skeleton",key:c},[Os,t("div",Ys,[t("span",Js,v(c),1),Xs]),Zs])),64))])):A("",!0),y.value.length>0?(a(),Ze(e(_s),{key:1,class:"scroller","data-key":"id","data-sources":y.value,"estimate-size":100,onTobottom:e(be)},{item:ie(({index:c,item:n})=>{var ae;return[t("a",{class:"item-link",href:Z(n)},[t("article",{class:cs(["feed-item selectable-card",{selected:e(d).includes(n.id)||n.id==s.$route.params.id,selecting:e(H).includes(n.id)}]),onClick:m(p=>e(he)(p,n,c,()=>{Fe(n)}),["stop","prevent"]),onMouseover:p=>e(fe)(p,c)},[t("div",tt,[e(H).includes(n.id)?(a(),l("md-checkbox",{key:0,class:"checkbox","touch-target":"wrapper",onClick:m(p=>e(K)(p,n,c),["stop"]),checked:e(ke)},null,8,ot)):(a(),l("md-checkbox",{key:1,class:"checkbox","touch-target":"wrapper",onClick:m(p=>e(K)(p,n,c),["stop"]),checked:e(d).includes(n.id)},null,8,at)),t("div",nt,v(n.title||s.$t("no_content")),1)]),t("div",lt,[t("span",ct,[r(Re,{id:c+1,raw:n},null,8,["id","raw"])]),t("div",it,[t("a",{onClick:m(p=>e(Ee)(z.value[n.feedId]),["stop","prevent"])},v((ae=z.value[n.feedId])==null?void 0:ae.name),9,dt),rt,E((a(),l("span",ut,[ds(v(e(rs)(n.publishedAt)),1)])),[[F,e(is)(n.publishedAt)]]),r(ze,{tags:n.tags,type:e(i),"only-links":!0},null,8,["tags","type"])])]),E((a(),l("button",_t,[pt,r(Be)])),[[F,s.$t("actions")]]),n.image?(a(),l("img",{key:0,class:"image",src:e(us)(n.image,"&w=200&h=200")},null,8,vt)):A("",!0)],42,st)],8,et)]}),footer:ie(()=>[e(O)?A("",!0):(a(),l("md-circular-progress",mt))]),_:1},8,["data-sources","onTobottom"])):A("",!0),!e(R)&&y.value.length===0?(a(),l("div",ht,v(s.$t(e(ps)(e(R)))),1)):A("",!0),t("div",{class:"sidebar-drag-indicator",onMousedown:o[3]||(o[3]=(...c)=>e(J)&&e(J)(...c))},null,32)],4)}}}),qt=Ss(ft,[["__scopeId","data-v-c75d0d53"]]);export{qt as default};
