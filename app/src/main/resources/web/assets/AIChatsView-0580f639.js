import{b as ot,u as st,_ as nt,a as at}from"./list-d04dc80e.js";import{_ as lt}from"./FieldId-4280c3b8.js";import{_ as ct}from"./Multiselect-94708f99.js";import{_ as it,a as ut}from"./label-outline-rounded-bf459c02.js";import{_ as dt}from"./delete-outline-rounded-11fb4e46.js";import{_ as rt}from"./Breadcrumb-99ff7c19.js";import{d as _t,q as pt,r as m,u as mt,C as ht,p as bt,D as ft,E as vt,G as gt,aW as yt,H as kt,I as Ct,t as $t,aX as Vt,K as wt,L as Tt,M as At,o as c,c as i,e as t,f as u,j as n,F as g,w as d,l as $,g as a,y as St,N as V,O as qt,P as Dt,Q as K,R as It,A as L,z as Ut,T as N,U as Bt,B as R,V as z,W as Qt,aY as G}from"./index-cf22a9d8.js";import{n as Mt}from"./list-6498ebd9.js";import{u as Ft,a as Kt,b as Lt}from"./tags-8dfd5c3d.js";import{t as Nt}from"./truncate-fe00352a.js";import"./VModal.vuevuetypescriptsetuptruelang-83ac7574.js";import"./vee-validate.esm-dd3b5249.js";import"./stringToArray-2bab501e.js";const Rt={class:"v-toolbar"},zt={class:"right-actions"},Gt=["title"],Pt=["title"],Et=["title"],Ht=["onClick"],Wt={class:"row mb-3"},jt={class:"col-md-3 col-form-label"},Ot={class:"col-md-9"},Xt=["onKeyup"],Yt={class:"row mb-3"},Jt={class:"col-md-3 col-form-label"},Zt={class:"col-md-9"},xt={class:"actions"},te=["onClick"],ee={class:"table"},oe=t("th",null,"ID",-1),se=["onClick"],ne=["onUpdate:modelValue"],ae=["onClick"],le={class:"badge"},ce={class:"nowrap"},ie={class:"nowrap"},ue={key:0},de={colspan:"6"},re={class:"no-data-placeholder"},Ae=_t({__name:"AIChatsView",setup(_e){var M,F;const w=pt(),l=m([]),{t:P}=mt(),r=ht({text:"",tags:[]}),h="AI_CHAT",T=bt().query,b=m(parseInt(((M=T.page)==null?void 0:M.toString())??"1")),f=50,v=m(0),_=m(ft(((F=T.q)==null?void 0:F.toString())??"")),A=m(""),{tags:y}=Ft(h,_,r,async o=>{o.push({name:"parent_id",op:"",value:""}),A.value=vt(o),await gt(),W()}),{addToTags:S}=Kt(h,l,y),{removeFromTags:q}=Lt(h,l,y),{deleteItems:D}=ot(yt,()=>{U()},l),E=kt(()=>l.value.some(o=>o.checked)),{selectAll:k,toggleSelect:I}=st(l),{loading:H,load:W,refetch:U}=Ct({handle:(o,s)=>{s?$t(P(s),"error"):o&&(l.value=o.aiChats.map(C=>({...C,checked:!1})),v.value=o.aiChatCount)},document:Vt,variables:()=>({offset:(b.value-1)*f,limit:f,query:A.value}),appApi:!0});wt(b,o=>{R(w,`/aichats?page=${o}&q=${z(_.value)}`)});function B(){_.value=Qt(r),Q()}function Q(){R(w,`/aichats?q=${z(_.value)}`)}Tt(()=>{At.on("refetch_by_tag_type",o=>{o===h&&U()})});function j(o){G(`/aichats/${o.id}`)}function O(){G("/aichats/create")}return(o,s)=>{const C=rt,X=dt,Y=it,J=ut,Z=ct,x=nt,tt=lt,et=at;return c(),i(g,null,[t("div",Rt,[u(C,{current:()=>`${o.$t("page_title.aichats")} (${v.value})`},null,8,["current"]),t("div",zt,[n(E)?(c(),i(g,{key:0},[t("button",{type:"button",class:"btn btn-action",onClick:s[0]||(s[0]=d((...e)=>n(D)&&n(D)(...e),["stop"])),title:o.$t("delete")},[u(X,{class:"bi"})],8,Gt),t("button",{type:"button",class:"btn btn-action",onClick:s[1]||(s[1]=d((...e)=>n(S)&&n(S)(...e),["stop"])),title:o.$t("add_to_tags")},[u(Y,{class:"bi"})],8,Pt),t("button",{type:"button",class:"btn btn-action",onClick:s[2]||(s[2]=d((...e)=>n(q)&&n(q)(...e),["stop"])),title:o.$t("remove_from_tags")},[u(J,{class:"bi"})],8,Et)],64)):$("",!0),t("button",{class:"btn btn-action",type:"button",onClick:d(O,["prevent"])},a(o.$t("new_chat")),9,Ht),u(x,{modelValue:_.value,"onUpdate:modelValue":s[5]||(s[5]=e=>_.value=e),search:Q},{filters:St(()=>[t("div",Wt,[t("label",jt,a(o.$t("keywords")),1),t("div",Ot,[V(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=e=>r.text=e),class:"form-control",onKeyup:Dt(B,["enter"])},null,40,Xt),[[qt,r.text]])])]),t("div",Yt,[t("label",Jt,a(o.$t("tags")),1),t("div",Zt,[u(Z,{modelValue:r.tags,"onUpdate:modelValue":s[4]||(s[4]=e=>r.tags=e),label:"name","track-by":"id",options:n(y)},null,8,["modelValue","options"])])]),t("div",xt,[t("button",{type:"button",class:"btn",onClick:d(B,["stop"])},a(o.$t("search")),9,te)])]),_:1},8,["modelValue"])])]),t("table",ee,[t("thead",null,[t("tr",null,[t("th",null,[V(t("input",{class:"form-check-input",type:"checkbox",onChange:s[6]||(s[6]=(...e)=>n(I)&&n(I)(...e)),"onUpdate:modelValue":s[7]||(s[7]=e=>It(k)?k.value=e:null)},null,544),[[K,n(k)]])]),oe,t("th",null,a(o.$t("content")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("updated_at")),1),t("th",null,a(o.$t("created_at")),1)])]),t("tbody",null,[(c(!0),i(g,null,L(l.value,e=>(c(),i("tr",{key:e.id,class:Ut({checked:e.checked}),onClick:d(p=>e.checked=!e.checked,["stop"])},[t("td",null,[V(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>e.checked=p},null,8,ne),[[K,e.checked]])]),t("td",null,[u(tt,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:d(p=>j(e),["stop"])},a(n(Nt)(e.content,{length:200,omission:""})),9,ae)]),t("td",null,[(c(!0),i(g,null,L(e.tags,p=>(c(),i("span",le,a(p.name),1))),256))]),t("td",ce,a(n(N)(e.updatedAt)),1),t("td",ie,a(n(N)(e.createdAt)),1)],10,se))),128))]),l.value.length?$("",!0):(c(),i("tfoot",ue,[t("tr",null,[t("td",de,[t("div",re,a(o.$t(n(Mt)(n(H)))),1)])])]))]),v.value>f?(c(),Bt(et,{key:0,modelValue:b.value,"onUpdate:modelValue":s[8]||(s[8]=e=>b.value=e),total:v.value,limit:f},null,8,["modelValue","total"])):$("",!0)],64)}}});export{Ae as default};
